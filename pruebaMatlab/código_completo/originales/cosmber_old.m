function [fA,m,s,nProds] = cosmber(A,NormEst)
%   COSMBER  Matrix cosine function based on Bernoulli polynomials.
%
%   cosmber(fA,NormEst) computes the matrix cosine cos(A) using a scaling 
%   and squaring algorithm and Bernoulli approximation with maximum order equal to 32.
%   Normest is an input that indicates if estimation norms of matrix powers are used.
%   If NormEst=0, then no estimation of norms of matrix powers are used,
%   else estimation of norms of matrix powers are used.
%   Function returns the matrix cosine, A; the appoximation
%   order used m; the scaling parameter s; and nprods in terms of 
%   number of matrix product evaluations.
%
%   References:
%   
%   [1] XXXXXXXXXXXXX
%
%   Author: XXXXXXXXXXXXX.
%   Revised version: 2019/06/03.
%
%   Group of High Performance Scientific Computation (HiPerSC)
%   Universitat Politecnica de Valencia (Spain)
%   http://hipersc.blogs.upv.es
%  

%% Check arguments
if nargin<1 || nargin>2
    error('cosmber:NumParameters','Incorrect number of input arguments.');
end
if nargin==1
    NormEst=1;
end

% Selection of optimal order m and scaling s
if NormEst==1
    [m,s,pB,nProd_select_ms] = ms_selectNormEst(A); 
elseif NormEst==0
    [m,s,pB,nProd_select_ms] = ms_selectNoNormEst(A); 
end
clear pB;
%m=20;q=5;
m=16;q=4;
%m=42/2;q=7;
%m=49/2;q=7;
pA{1}=A*A;
nProd_select_ms=1;
for i=2:q
    pA{i}=pA{i-1}*pA{1};
    nProd_select_ms=nProd_select_ms+1;
end

%pA{1}=A;
%for i=2:q
%    pA{i}=pA{i-1}*A;
%end
% Scaling
pA=scaling(pA,s);

% Computation of Bernoulli coefficients
formulacion=1; % Sólo pares
%formulacion=2; % Pares e impares
%p=coefs_cos_bernoulli2(m,formulacion);
formulacion='pares';
p=coefs_cos_bernoulli2(m,formulacion);

% Evaluation of Bernoulli matrix polynomial by Paterson-Stockmeyer method
[fA,nProd_PS] = polyvalm_paterson_stockmeyer(p,pA);

% Recovering cos(A) from the scaled aproximation cos(2^(-s)*A)
[fA,nProd_sq] = squaring(fA,s);

% Total number of matrix products
nProds=nProd_select_ms+nProd_PS+nProd_sq;
end

%%Auxiliary functions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [m,s,pB,nProd]=ms_selectNormEst(A)
% [m,s,pB,nProd]=ms_selectNormEst(A)
% Obtiene los valores apropiados del grado del polinomio (m) y el escalado
% (s) de la matriz, con estimaciones de la norma de las potencias 
% matriciales, para aplicar la función coseno sobre A.
%
% Datos de entrada:
% - A:          Matriz de la cual calculamos cos(A).
%
% Datos de salida:
% - m:          Orden de la aproximación polinómica a f(A). El grado del 
%               polinomio de aproximación a f(A) será 2*m.
% - s:          Valor del escalado de la matriz.
% - pB:         Vector de celdas con las potencias de B=A^2, de modo que
%               pB{i} contiene B^i, para i=1,2,3,...,q, siendo q<=4.
% - nProd:      Número de productos matriciales llevados a cabo al calcular  
%               las potencias de A.
%
% m: 1 2 4  6    9   12   16
% q: 1 2 2  2,3  3   3,4  4
% Theta from forward and backward error bounds
Theta=[5.161913593731081e-08      %m=1  forward bound
       4.307691256676447e-05      %m=2  forward bound
       1.319680929892753e-02      %m=4  forward bound
       1.895232414039165e-01      %m=6  forward bound
       1.7985058769167590         %m=9  backward bound
       6.752349007371135          %m=12 backward bound
       9.971046342716772];        %m=16 backward bound

d=zeros(1,17); %||B^k||, B=A^2
b=zeros(1,17); %||B^k||^(1/k), B=A^2
%Initial scaling parameter s = 0 
s = 0;

% m = 1
pB{1}=A*A;
d(1)=norm(pB{1},1);
nProd=1;
q=1;
b(1)=d(1);
if d(1)<=Theta(1)
    m=1;
    return
end

% m = 2
P=pB{1}*pB{1};
d(2)=norm(P,1);
nProd=nProd+1;
q=2;
b(2)=d(2)^(1/2);
if d(2)==0
    m=1;
    q=1;
    return
end %Nilpotent matrix
pB{2}=P; 

beta_min = beta_NoNormEst(b,d,2,q);
if beta_min<=Theta(2)
    m=2;
    return
end

% m = 4
beta_min = min(beta_min,beta_NoNormEst(b,d,4,q));
if beta_min<=Theta(3)
    d(3)=norm1pp(pB{2},1,pB{1});b(3)=d(3)^(1/3); %Test if previous m = 2 is valid
    if b(3)<=Theta(2)
        d(4)=min(d(2)^2,d(3)*d(1));
        b(4)=d(4)^(1/4);
        if b(4)<=Theta(2)
            m=2;
            return
        end
        d(4)=norm1p(pB{2},2);
        b(4)=d(4)^(1/4);
        if b(4)<=Theta(2)
            m=2;
            return
        end
    end
    m=4;
    return
end

% m = 6
d(6)=min(d(3)^2,d(2)^3);
beta_min = min(beta_min,beta_NoNormEst(b,d,6,q));
if beta_min<=Theta(4)
    d(5)=norm1pp(pB{2},2,pB{1});
    b(5)=d(5)^(1/5); %Test if previous m = 4 is valid
    if b(5)<=Theta(3)
        d(6)=min(d(5)*d(1),d(2)^3);
        b(6)=d(6)^(1/6);  
        if b(6)<=Theta(3)
            m=4;
            return
        end %Considering only two terms
        d(6)=norm1p(pB{2},3);
        b(6)=d(6)^(1/6);
        if b(6)<=Theta(3)
            m=4;
            return
        end
    end
    m=6; 
    return
end

P=pB{2}*pB{1};
d(3)=norm(P,1);
nProd=nProd+1;
q=3; 
b(3)=d(3)^(1/3);
if b(3)==0
    m=2;
    q=2; 
    return
end %Nilpotent matrix
pB{3}=P; 
d(6)=min(d(3)^2,d(2)^3);
beta_min = min(beta_min,beta_NoNormEst(b,d,6,q));
if beta_min<=Theta(4)
    m=6; 
    return
end

% m = 9
d(9)=d(6)*d(3);
b(9)=d(9)^(1/9);
d(10)=min(d(9)*d(1),d(6)*d(2)^2);
b(10)=d(10)^(1/10);
beta_min9=min(beta_min,max(b(9:10)));      %Considering only two terms
if beta_min9<=Theta(5) 
    d(7)=norm1pp(pB{3},2,pB{1});
    b(7)=d(7)^(1/7);  %Test if previous m = 6 is valid
    if b(7)<=Theta(4)
        d(8)=min(d(7)*d(1),d(6)*d(2));
        b(8)=d(8)^(1/8);
        if b(8)<=Theta(4)
            m=6; 
            return 
        end
        d(8)=min(d(8),norm1p(pB{2},4));
        b(8)=d(8)^(1/8);
        if b(8)<=Theta(4)
            m=6; 
            return
        end
    end
    m=9; 
    return
end

%Orders for scaling
d(12)=norm1p(pB{3},4);
b(12)=d(12)^(1/12);
d(13)=norm1pp(pB{3},4,pB{1});
b(13)=d(13)^(1/13);
beta_min12=max(b(12:13)); %Considering only two terms
s9aux=max(0,ceil(log2(beta_min12/Theta(5))/2));
s12=max(0,ceil(log2(beta_min12/Theta(6))/2));
if s9aux<=s12 %No scaling (s=0) included
    s9=max(0,ceil(log2(beta_min9/Theta(5))/2));
    if s9<=s12
        m=9; 
        s=s9; 
        return
    end
    d(9)=norm1p(pB{3},3);
    b(9)=d(9)^(1/9);
    d(10)=min(d(9)*b(1),d(6)*d(2)^2);
    b(10)=d(10)^(1/10);
    beta_min9=min(beta_min9,max(b(9:10)));
    s9=max(0,ceil(log2(beta_min9/Theta(5))/2));
    if s9<=s12
        m=9; 
        s=s9; 
        return
    end
    d(10)=norm1pp(pB{3},3,pB{1});
    b(10)=d(10)^(1/10);
    beta_min9=min(beta_min9,max(b(9:10)));
    s9=max(0,ceil(log2(beta_min9/Theta(5))/2));
    if s9<=s12
        m=9;
        s=s9; 
        return
    end
end

P=pB{3}*pB{1};
d(4)=norm(P,1);
nProd=nProd+1;
q=4; 
b(4)=d(4)^(1/4);
if b(4)==0
    m=3; 
    q=3; 
    return
end %Nilpotent matrix
pB{4}=P; 

d(6)=min(d(6),d(4)*d(2));
d(9)=min([d(9),d(4)^2*d(1),d(4)*d(3)*d(2)]); %d(9)  may have been estimated
d(10)=min([d(10),d(4)^2*d(2),d(6)*d(4)]);    %d(10) may have been estimated
d(16)=min([d(12)*d(4),d(13)*d(3),d(9)*d(4)*d(3),d(10)*d(6)]);
b(16)=d(16)^(1/16);
d(17)=min([d(12)*min(d(3)*d(2),d(4)*d(1)),d(13)*d(4),d(9)*min(d(4)^2,d(6)*d(2)),d(10)*d(4)*d(3)]);
b(17)=d(17)^(1/17);
beta_min16 = min(beta_min12,max(b(16:17)));
s12=max(0,ceil(log2(beta_min12/Theta(6))/2));
if s12==0
    m=12;
    s=0;
    return
end

s16=max(0,ceil(log2(beta_min16/Theta(7))/2));
if s12<=s16
    d(16)=min(d(16),norm1p(pB{4},4));
    b(16)=d(16)^(1/16);
    s16aux=max(0,ceil(log2(b(16)/Theta(7))/2)); %Temptative scaling for m=16
    if s16aux<s12    
        d(17)=min(d(17),d(16)*b(1));
        b(17)=d(17)^(1/17);
        beta_min16=min(beta_min16,max(b(16:17)));
        s16=max(0,ceil(log2(beta_min16/Theta(7))/2));
        if s16<s12
            m=16; 
            s=s16; 
            return
        end  %If m=16 has a lower scaling s16 and the same or less cost than m=12, m=16 is preferred
        d(17)=norm1pp(pB{4},4,pB{1});
        b(17)=d(17)^(1/17);
        beta_min16=min(beta_min16,max(b(16:17)));
        s16=max(0,ceil(log2(beta_min16/Theta(7))/2));
        if s16<s12
            m=16; 
            s=s16; 
            return
        else
            m=12; 
            s=s12; 
            return
        end %If m=16 has a lower scaling s16 and the same or less cost than m=12, m=16 is preferred
    else
        m=12; 
        s=s12; 
        return
    end %If m=12 has the same or less cost than m=16, m=12 is preferred
else
    m=16;
    s=s16;
    return
end
end

function [m,s,pB,nProd]=ms_selectNoNormEst(A)
% [m,s,pB,nProd]=ms_selectNoNormEst(A)
% Obtiene los valores apropiados del grado del polinomio (m) y el escalado
% (s) de la matriz, sin estimaciones de la norma de las potencias 
% matriciales, para aplicar la función coseno sobre A.
%
% Datos de entrada:
% - A:          Matriz de la cual calculamos cos(A).
%
% Datos de salida:
% - m:          Orden de la aproximación polinómica a f(A). El grado del 
%               polinomio de aproximación a f(A) será 2*m.
% - s:          Valor del escalado de la matriz.
% - pB:         Vector de celdas con las potencias de B=A^2, de modo que
%               pB{i} contiene B^i, para i=1,2,3,...,q, siendo q<=4.
% - nProd:      Número de productos matriciales llevados a cabo al calcular  
%               las potencias de A.
%
% m: 1 2 4 6 9 12 16
% q: 1 2 2 3 3  4  4
% Theta from forward and backward error bounds
Theta=[5.161913593731081e-08      %m=1  forward bound
       4.307691256676447e-05      %m=2  forward bound
       1.319680929892753e-02      %m=4  forward bound
       1.895232414039165e-01      %m=6  forward bound
       1.7985058769167590         %m=9  backward bound
       6.752349007371135          %m=12 backward bound
       9.971046342716772];        %m=16 backward bound

d=zeros(1,17); %||B^k||, B=A^2
b=zeros(1,17); %||B^k||^(1/k), B=A^2
%Initial scaling parameter s = 0 
s = 0;

% m = 1
pB{1}=A*A;
d(1)=norm(pB{1},1);
nProd=1; 
q=1; 
b(1)=d(1);
if b(1)<=Theta(1) 
    m=1; 
    return
end

% m = 2
P=pB{1}*pB{1};
d(2)=norm(P,1);
nProd=nProd+1; 
q=2; 
b(2)=d(2)^(1/2);
if b(2)==0
    m=1; 
    q=1; 
    return
end %Nilpotent matrix
pB{2}=P; 

beta_min = beta_NoNormEst(b,d,2,q);
if beta_min<=Theta(2)
    m=2; 
    return
end

% m = 4
beta_min = min(beta_min,beta_NoNormEst(b,d,4,q));
if beta_min<=Theta(3)
    m=4; 
    return
end

% m = 6
P=pB{2}*pB{1};
d(3)=norm(P,1);
nProd=nProd+1; 
q=3; 
b(3)=d(3)^(1/3);
if b(3)==0
    m=2;
    q=2; 
    return
end %Nilpotent matrix
pB{3}=P;

d(6)=min(d(3)^2,d(2)^3);
beta_min = min(beta_min,beta_NoNormEst(b,d,6,q));
if beta_min<=Theta(4)
    m=6; 
    return
end

% m = 9
beta_min9 = min(beta_min,beta_NoNormEst(b,d,9,q));
if beta_min9<=Theta(5)
    m=9; 
    return
end

% m = 12
beta_min12 = min(beta_min9,beta_NoNormEst(b,d,12,q));
if beta_min12<=Theta(6)
    m=12; 
    return
end

%m=9 only used for scaling if cost is lower than cost with m=12,16
s9 = ceil(log2(beta_min9/Theta(5))/2); %Scaling s=0 not included
s12 = ceil(log2(beta_min12/Theta(6))/2);
if s9<=s12
    m=9; 
    s=s9; 
    return
end

% m = 12
P=pB{3}*pB{1};
d(4)=norm(P,1);
nProd=nProd+1; 
q=4; 
b(4)=d(4)^(1/4);
if b(4)==0
    m=3;
    q=3;
    return
end %Nilpotent matrix
pB{4}=P;

d(6)=min(d(6),d(4)*d(2));
beta_min12 = min(beta_min12,beta_NoNormEst(b,d,12,q)); %We have new information with pB{4}=B^4
if beta_min12<=Theta(6)
    m=12;
    s=0;
    return
end

%m=12 only used for scaling if cost is lower than cost with m=16
s12 = ceil(log2(beta_min12/Theta(6))/2);
beta_min16 = min(beta_min12,beta_NoNormEst(b,d,16,q));
s16 = max(0,ceil(log2(beta_min16/Theta(7))/2)); %Scaling s=0 included
if s12<=s16
    m=12;
    s=s12;
    return
else
    m=16;
    s=s16;
    return
end

end

function Beta_min = beta_NoNormEst(b,d,m,q)
% Beta_min = beta_NoNormEst(b,d,m,q) 
% Computes beta_min with only products of norms of known matrix powers
% m = order of approximation (2,4,6,9,12,16,>=20)
% d = norm(B^k,1), k=1:q
% b = norm(B^k,1)^1/k, k=1:q
switch m
    case 2                                             %m = 2
        Beta_min = (d(2)*d(1))^(1/3);
    case 4                                             %m = 4
        Beta_min = (d(2)^2*d(1))^(1/5);
    case 6                                             %m = 6
        if q == 2
            Beta_min = min(d(2)^3*d(1))^(1/7);
        elseif q == 3
            if b(2) <= b(3)
                Beta_min = min(d(2)^2*d(3),d(1)*d(6))^(1/7);
            else
                Beta_min = max(min(d(2)^2*d(3),d(1)*d(6))^(1/7),(d(6)*d(2))^(1/8));
            end
        end    
    case 9                                             %m = 9
        if b(2) <= b(3)
            Beta_min = (d(2)^3*d(3))^(1/9);
        else
            Beta_min = max(min(d(2)^2*d(3)^2,d(3)^3*d(1))^(1/10),(d(3)^3*d(2))^(1/11));
        end
    case 12                                              %m = 12       
         if q == 3 
            if b(2) <= b(3)
                Beta_min = (d(2)^5*d(3))^(1/13);
            else
                Beta_min = min(d(3)^4*d(1),d(3)^3*d(2)^2)^(1/13);
            end
        elseif q == 4
            if b(3) <= b(4)
                Beta_min = max((d(3)^3*d(4))^(1/13),min(d(3)^2*d(4)^2,d(3)^4*d(2))^(1/14));
            else
                Beta_min = max((d(4)^2*min(d(3)*d(2),d(4)*d(1)))^(1/13),(d(4)^2*d(6))^(1/14));
            end                    
        end       
    case 16                                              %m = 16
        if b(3) <= b(4)
            Beta_min = max((d(3)^4*d(4))^(1/16),min(d(3)^5*d(2),d(3)^3*d(4)^2)^(1/17));
        else
            Beta_min = max((d(4)^3*min(d(4)*d(1),d(3)*d(2)))^(1/17),(d(4)^3*d(6))^(1/18));
        end
    otherwise                                              %m >= 20
        if b(3) <= b(4)
            Beta_min = max(min(d(3)^6*d(2),d(3)^4*d(4)^2)^(1/20),(d(3)^6*d(4))^(1/22));
        else
            Beta_min = max(min(d(4)^5*d(1),d(4)^4*d(3)*d(2))^(1/21),(d(4)^4*d(6))^(1/22));
        end
end
if isnan(Beta_min)||isinf(Beta_min)
    error('cosmber:NanInfEstimation',['Nan or inf appeared in bounding the norms of high matrix powers with products of the norms of known matrix powers, check matrix'])
end
end

function pB=scaling(pB,s)
% pB=scaling(pB,s)
%
% Escalado de las potencias de la matriz B=A^2.
%
% Datos de entrada:
% - pB: Vector de cells arrays con las potencias de B, de modo que
%       pB{i} contiene B^i, para i=1,2,3,...,q, siendo B=A*A.
% - s:  Valor del escalado de la matriz.
%
% Datos de salida:
% - pB: Vector de cells arrays con las potencias de B=A^2 escaladas.

if s>0
    q=length(pB);
    for k=1:q
        pB{k}=pB{k}/(4^(k*s));
        %pB{k}=pB{k}/(2^(k*s));
    end
end

end

function [A,nProd] = squaring(A,s)
% [A,nProd] = squaring(A,s)
%
% Técnica de squaring de la matriz A, tras haber aplicado la función
% coseno.
%
% Datos de entrada:
% - A:     Matriz resultado de la evaluación del polinomio de aproximación.
% - s:     Valor del escalado de la matriz.
%
% Datos de salida:
% - A:     Resultado tras la técnica de squaring.
% - nProd: Número de productos matriciales que se han llevado a cabo
%          con el reescalado.

n=size(A,1);
I=eye(n);
% Recovering cos(A) from the scaled aproximation cos(2^(-s)*A)
for i = 1:s % double angle phase
    A = 2*A*A-I;  
end

nProd=s;
end

function p = coefs_cos_bernoulli(m,formulacion)
% p = coefs_cos_bernoulli(m,formulacion)
% Coeficientes de la aproximación de Bernoulli en el cálculo de cos(A).
%
% Datos de entrada:
% - m:           Orden de la aproximación, de modo que el grado del 
%                polinomio a emplear será 2*m.
% - formulación: valdrá 1 cuando se emplea la formulación teórica de los 
%                términos pares y 2 cuando se emplea la de todos los 
%                términos (pares e impares).
%
% Datos de salida:
% - p:           vector de 2*m+1 componentes con los coeficientes de menor 
%                a mayor grado. 

switch m
    case 1
        if formulacion==1 % Pares
            p=vpa([26527538895367489/27021597764222976, 0, -3789648413623927/9007199254740992]);
        else % Pares e impares
            p=vpa([54107898733835129/54043195528445952, -350940314366717/9007199254740992, -3789648413623927/9007199254740992]);
        end
    case 2
        if formulacion==1 % Pares
            p=vpa([1618179872617416829/1621295865853378560, 0, -26527538895367489/54043195528445952, 0, 3789648413623927/108086391056891904]);            
        else % Pares e impares
            p=vpa([3242684275616483813/3242591731706757120, -2945626850415/4503599627370496, -54107898733835129/108086391056891904, 350940314366717/54043195528445952, 3789648413623927/108086391056891904]);
        end        
    case 3
        if formulacion==1 % Pares
            p=vpa([13616206750150769711/13618885273168379904, 0, -1618179872617416829/3242591731706757120, 0, 26527538895367489/648518346341351424, 0, -3789648413623927/3242591731706757120]);
        else % Pares e impares
            p=vpa([136188949927478696219/136188852731683799040, -8426161383913/540431955284459520, -3242684275616483813/6485183463413514240, 981875616805/9007199254740992, 54107898733835129/1297036692682702848, -350940314366717/1080863910568919040, -3789648413623927/3242591731706757120]);
        end
    case 6
        if formulacion==1 % Pares
            p=vpa([2944620293757971629718942599/2944620898223374429323264000, 0, -539306764356676276957427/1078615713634935688396800, 0, 2723722635378684180929/65370649311208223539200, 0, -13616206750150769711/9805597396681233530880, 0, 231168553231059547/9338664187315460505600, 0, -3789648413623927/14007996280973190758400, 0, 3789648413623927/2157231427269871376793600]);
        else % Pares e impares
            p=vpa([5889241796514791010035118983/5889241796446748858646528000, -44802955820219/179769285605822614732800, -1078615714127003308397299/2157231427269871376793600, 8939637672473/5447554109267351961600, 5447554207450734224833/130741298622416447078400, -8849717458459/2723777054633675980800, -136188949927478696219/98055973966812335308800, 1203737340559/389111007804810854400, 3242684275616483813/130741298622416447078400, -196375123361/108951082185347039232, -54107898733835129/196111947933624670617600, 350940314366717/359538571211645229465600, 3789648413623927/2157231427269871376793600]);
        end 
   case 8
        if formulacion==1 % Pares
            p=vpa([24028106478863755186242096851993/24028106529502735343277834240000, 0, -5889241673951298719213397193/11778483592893497717293056000, 0, 2944620293757971629718942599/70670901557360986303758336000, 0, -539306764356676276957427/388301656908576847822848000, 0, 2723722635378684180929/109822690842829815545856000, 0, -13616206750150769711/49420210879273416995635200, 0, 231168553231059547/110943330545307670806528000, 0, -3789648413623927/336528102654099934779801600, 0, 3789648413623927/94227868743147981738344448000]);
        else % Pares e impares
            p=vpa([48056213059005825690108996381721/48056213059005470686555668480000, -24135276402277/151006199908890996375552000, -906037199453611101968723117/1812074398906691956506624000, 6195237858267823/5889241796446748858646528000, 5889241796514791010035118983/141341803114721972607516672000, -44802955820219/21572314272698713767936000, -1078615714127003308397299/776603313817153695645696000, 8939637672473/4575945451784575647744000, 5447554207450734224833/219645381685659631091712000, -8849717458459/8236701813212236165939200, -136188949927478696219/494202108792734169956352000, 1203737340559/3081759181814101966848000, 3242684275616483813/1553206627634307391291392000, -196375123361/1869600570300555193221120, -54107898733835129/4711393437157399086917222400, 350940314366717/11778483592893497717293056000, 3789648413623927/94227868743147981738344448000]);
        end
    case 10
        if formulacion==1 % Pares
            p=vpa([ 857849432478904660074285244815322006117931/857849432497464680610973561864606187520000, 3789648413623927/12533514435839581372562925416853012480000, -49151036992797064003109537489371696633/98302074006584951941670003269435392000, 3789648413623927/15318739866026155010910242176153681920000, 7659369916871036451283430701123529597177/183824878392313860130922906113844183040000, 3789648413623927/15318739866026155010910242176153681920000, -2321021143545211011342599421406076093/1671135258111944183008390055580401664000, 3789648413623927/107231179062183085076371695233075773440000, 828935969774264113581152860371069817/33422705162238883660167801111608033280000, 0, -539306764356676276957427/1957040350819227313027153920000, 0, 2723722635378684180929/1304693567212818208684769280000, 0, -13616206750150769711/1187271146163664569903140044800, 0, 231168553231059547/4846004678219039060829143040000, 0, -3789648413623927/24714623858917099210228629504000, 0, 3789648413623927/10956816577453247316534692413440000]);
        else % Pares e impares
            p=vpa([2023920734693538389262430847967668255583589215673/2023920734693538431106747480612917919791185920000, -1148367706979244449/19174429010543182803935711723520000, -3011786807579670773300474830837356423331481333/6023573615159340568770081787538446189854720000, 32092607948258801/48056213059005470686555668480000, 48056213059005825690108996381721/1153349113416131296477336043520000, -24135276402277/18120743989066919565066240000, -906037199453611101968723117/652346783606409104342384640000, 8980370400110812212917126857/7170920970427786391392954508974340702208000, 37348546721409565606332952304983358660147/1505893403789835142192520446884611547463680000, -44802955820219/65234678360640910434238464000, -1078615714127003308397299/3914080701638454626054307840000, 8939637672473/36241487978133839130132480000, 5447554207450734224833/2609387134425636417369538560000, -8849717458459/141341803114721972607516672000, -136188949927478696219/11872711461636645699031400448000, 92595180043/7766033138171536956456960000, 3242684275616483813/67844065495066546851608002560000, -196375123361/106791584575567712636790374400, -3182817572578537/20353219648519964055482400768000, 350940314366717/1095681657745324731653469241344000, 3789648413623927/10956816577453247316534692413440000]);
        end
    case 15
        if formulacion==1 % Pares
            p=vpa([85397542641228492787856544092968038885765956613018313356475171927798514006626532898888174276856804607530158289/85397542641228512697590835060633993681305269976180077403229138580325402737343693615329736567647273620602880000, 43276184130031323308408516108167932740210462381506965896823365775478565705079192542069/196592259621994805272578901545834506287171506924331219855350412773457437551593294676956997723437994480762880000, -10921792201221908699578656787771274507326978321001435181496271771018634918290016981902495045088794628433955857/21843584402443867252508766838426056254130167436036802206150045863717493061288143852995221969270888275640320000, 35836833513169340191445550650132146040455609287146091804017249678212513071912200194381/393184519243989610545157803091669012574343013848662439710700825546914875103186589353913995446875988961525760000, 65530753207330126886285504686721918026774492164453519827975260433340600221893661412146239231330650678889309433/1572738076975958442180631212366676050297372055394649758842803302187659500412746357415655981787503955846103040000, 64577794514767656680845634120030498889793357602066229831959568141361064759925616465851/393184519243989610545157803091669012574343013848662439710700825546914875103186589353913995446875988961525760000, -1092179220121950776488433020768511958040552520677847854842643318879999021938555514186168039484291583288824261/786369038487979221090315606183338025148686027697324879421401651093829750206373178707827990893751977923051520000, 3155878356232618701585835594578219291995790287411312843332889395963615251527556894727/131061506414663203515052601030556337524781004616220813236900275182304958367728863117971331815625329653841920000, 15602560287425702199641198855569679770019538473217186092845938285886647623199052754180905595635289548770569/629095230790383376872252484946670420118948822157859903537121320875063800165098542966262392715001582338441216000, -321050557408380983674652387226734906057638933381611084578724559277919613638215048339/1179553557731968831635473409275007037723029041545987319132102476640744625309559768061741986340627966884577280000, -30957460887147491347528783689560579506716911169569757780962881517180982802927653997956314011690231815281/112338434069711317298616515169048289306955146813903554203057378727689964315196168386832570127678853989007360000, -336788617184660987226205035240547834351928711529151938199340387336533612286287253/13558086870482400363626131141092034916356655649953877231403476742997064658730572046686689498168137550397440000, 3283367063158297525116007738883826489586136975328135346084401931435490706971953090020416132996110193753/1572738076975958442180631212366676050297372055394649758842803302187659500412746357415655981787503955846103040000, -670913228029773411072492979814554919413521376374074187985492288777/3851403582533775637892194872389930832962076883566223942131276465722430870679561676505364127809536, -846255668206856694752067872036055904564132242029936067493007168708936928425589887995039905475897/73775123228068226014665128640898585716172814306907297065522248906448048616790803894157800065086028513280000, -16324133936801913654909760384953613852241562648457/4444552214178759779073494278035784798608918012016925247054329995244707051198218240, 16925113047766511927654283852013070876733104826963233567761493577769400455633800049127705344867/354120591494727484870392617476313211437629508673155025914506794750950633360595858691957440312412936863744000, 11368945240871781/487549460186063096424793062179273256367827038765056, -35980250691870739498719740408218508374837216081928905662469544756586778288258504383809576623/230359058242743644494770707797091502338253889570547274510712328218092886497326387669513130815472701276160000, 0, 2342459973543040664435895561561044494028387384276901105910013754685352703313812489685903/5698987117984543288282087823105128313055760288854685176697310203312193806574480944948892559236954849280000, 0, -2732820904006785404171072824498745847088035595101740762023158264680694572438299149545653/3071754056593668832384045336653664160737054795692675310239850199585272461743645229327453089428718663761920000, 0, 48486179622836482940285660217906473469319856587739521011856959808223867/30089090488545122171032772440546334632516225652861124547900597388456491177184075597698157248512, 0, -75173634319591240733102297304152067634392524229237715/30375263504847084323049175516414618709450504917111643354598498449520860273311744, 0, 16665793025972555889840041518466821/5175840341226362841357910345393433453529964640948544088796299264, 0, -3789648413623927/1194592680609141946167223369361737392446611914752]);
        else % Pares e impares
            p=vpa([4793106520307682749514052230702473616810380912622406970445267682564848051077118784514375306478469873338314241307/4793106520307682871407637980546060343763419597393218312663781492381438477448369851171522992114297770197647360000, 3547717024231548597294146715385184691613846880736954560802798556704604773515883329271522377/83112111089694917840617515616877307725111971950659682506527448383712986723589142017721513982599808784793600, -41117335345776690253184350055854968654329369260552821420785893884187518897146103314279210467083233583076925759/82234670691553382597680063391721623544960630347432667129035466781054091524849482740687894472549226449469440000, -1195614265855350307113174841030351752251439131611956248816282182514591034667434694093286401/168057577571074282398307476431185732532395531517878034480110649305301995213139809227010414303051083939840000, 3355174564215377924660095747606332212819868945381800144731883768749724638415628715948156386420568284940166486987/80524189541169072239648318073173813775225449236206067652751529072008166421132613499681586267520202539320475648000, 2301744862014738320825724637788046220663406822033635207146067755729038578948673073139/6470989889557003166038193093213199568744153580698323862204043832494323784571189687290711858258903040000, -45507467505091388952230837979688121042289022752718688281683050709863648406996289833838948969536607418228761/32765376603665800878763150257639084381195251154055203309225068795576239591932215779492832953906332413460480000, -2436277974581697504261775289700838960541104718962317293789658738869890503922821236297/288099723778537880087961292497839841669304924636307984125953951498877719800039053903725606211178987520000, 187530772685816163286707909690976121753082378418847776797243698900363343054539860731310413438903479562221/7561240754692107895099188520993634857198904112474277686744246645132978367368972872190653758593769018490880000, 93697500414617112762022920976639014586759547779951720037506707866604889706038301329613/848165586804015518978958045113640493874433698129290705266808433212696007091314974692568184685710939258880000, -1155745206478511470946841194485673838023011634223345877219840492899895330824221461750369746917005924576237/4193968205269222512481683232977802800792992147719066023580808805833758667767323619775082618100010548922941440000, 2832863072311261159371905503244274201193340701377472463377215299466610405771860345167/1888090349755025850944463126513843186363956754096508004767851816543045024481535943663456132865582612611072000, 747148416309340885629729735799066762910677925658849054782174469827601664911873689983646691459470819717887/357885286849640321065103635880772505667668663272026967345562351431147406316144948887473716744534233508091002880000, -10942691085003895960108012450901721977664309955702645805684296548328028694245471641/17005826301834897623638256543631889601492404975023372536677863322560320944186766409876053828284931112960000, -8332363519904864616050816282974768314998065173662121464505517582423103012660109500480936186253857/726401213322517917682856651233462997820778479329548771106680604617334632534555607573246031410077819207680000, 11174160010693632720569022255311278574112248962433266686587529370518029843547286012847/91423322198664409624679267178565038497623169145725650757180193222084285395948056219493665380859789663272960000, 1386505289712564947457191358744118575988467836900313518269825010278696906556334862109828022058550231/29009558855248075560582563223659578280970609350504859722916396625997875884900012744045153510392867787877908480000, -2200036645147646434899649728150344506452514425603355289532560876302802503/123979128701965198060381591210960024403946389254518500976838538438678134123099237578719121899520000, -64476622476198772599308592086430547252239626943780168989486367148464333008060272139500984326601/412803432370996610934629108372387972190150970110420715923196492166822452603208886703767530421327080686878720000, 8783550895505322467051628078744443065286844310014632368462874281006586887/4287198270513956548927995424074997643888466140421249763779076659209489877976771635472107235285401600, 1929088592674951159373431933779374003708670346094749135567523784027102316751899920207193/4693283508928447413879366442557164493104743767292093674927196638021806664237807837016735048783374581760000, -2602614384760497483424602401608100440079420213416786371454844889692472629791/13504674552118963129123185585836242578248668342326936755904091476509893115626830651737137791149015040000, -5614784922203457162120669898776646342047153125239798506256160877463569451277233197907889258157449603441/6311022225125420994359911588511598968739793772550943502937546936299179691323536973863885459516850680446749758783215370240000, 236106180954572056024792317610934267881722217954426829268045666464155092935197/15655346727178876481311909755741504777660427037485002397795947932671830851579158410025833556780051639304192, 700566730523605586070895896573205872903174324454659904255956836936464300769267784412219/434665198047287710799322580568539301290066177590839265102400037416467235316303531391200539752674292014235254784, -777903772298705807699774633258708282680213898542291363966987453/773896360302086534146251253454527612074422879032011595767013749560075100529745601165283819520, -41440394513395110164547081385699047853161932243856419651536901401297/16712080288437537791013337670389417723382353481823925689197914795544131361963422218148384866304, 1425427879921595310780193560343494331559991715/23730674613161782473683855431650423804844906879528005619803798007192404099072, 22245772089184144394011570288578591080886603590985/6774366018476027052282985953415200549802208513250356410725828483420611531505664, -3444945144302716033194402337613/781767551539398510610576227877166390530236401329927247129214976, -3789648413623927/1194592680609141946167223369361737392446611914752]);
        end        
    case 18
        if formulacion==1 % Pares
            p=vpa([524199307813196754852214220572038718027182582717727893221761216542162016803216366627590465095045309660697761006140615871367216207554027765678401386644422239111621656129/524199307813196756085079926651524841347981220522852493110492126371428930505690790901525553627897520108921081161142056864039331147319840385088313399162259331801415680000, 2125157185543207275195659394167376097440192515130489131660751143333282432297974252476808289565470546426544035244580568490574574126682077568886297/9654003918893040257900221982498915828158654144629200081451563327340482803479805399103095612647112662005963244717699547246057681963140393758709771767904942694009405440000, -1072667102099226690513109203066017915418019431606800558391179768168029233945622066351429502226011911895424941252546248025076339461266624733073150816244260594781066085557/2145334204198453390644493773888647961813034254362044462544791850520107289662178977578465691699358369334658498826155454943568373769586754168602171503978876154224312320000, 879924409318490503981915474888412637566663064806685819162277217438418463433716193749756746255362472843271680981503775512324161853359549920516589/9654003918893040257900221982498915828158654144629200081451563327340482803479805399103095612647112662005963244717699547246057681963140393758709771767904942694009405440000, 1609000653148840001921930213198776636524197064590442106008372968760197414029456945451626573439436670718763256937990149035264628887106922340559570527001185271522409098277/38616015675572161031600887929995663312634616578516800325806253309361931213919221596412382450588450648023852978870798188984230727852561575034839087071619770776037621760000, 792801894075135876237630545685489473280866627981948201826238176214860487685347893597270917995381153120407800154327594494994724354587544421646947/4827001959446520128950110991249457914079327072314600040725781663670241401739902699551547806323556331002981622358849773623028840981570196879354885883952471347004702720000, -13408338776240330565483433937074622720245340934482347989557593863912101637431705355722237589351283332758773983306395387114475055910740171313758917099990458930007390217/9654003918893040257900221982498915828158654144629200081451563327340482803479805399103095612647112662005963244717699547246057681963140393758709771767904942694009405440000, 38743726604025503982942071159151371657625792625876279375724706992583581467314021287004796294659942955104607046609933727934368355126288193550569/1609000653148840042983370330416485971359775690771533346908593887890080467246634233183849268774518777000993874119616591207676280327190065626451628627984157115668234240000, 191547696803432901283404694531590181288545098641415645960708948847697858550192557708014853074740503468007003202769827310005047529559326618323788875228463049360976043/7723203135114432206320177585999132662526923315703360065161250661872386242783844319282476490117690129604770595774159637796846145570512315006967817414323954155207524352000, -7882570525577891569088134877456230138171712092309051869622593508645811753878768480282745077077796863376946679836911948177592863186272495044591/28962011756679120773700665947496747484475962433887600244354689982021448410439416197309286837941337986017889734153098641738173045889421181276129315303714828082028216320000, -760109907950115187985991817683989121296834613297753328268472318600155807086981678985889310918022356262598283072057344126378223608969385586468871250054506142811189/2758286833969440073685777709285404522331044041322628594700446664954423658137087256886598746470603617715989498490771299213159337703754398216774220505115697912574115840000, -8268834594210601505566481091369932475553443125093933397339079269905986080254588025660601899727523626029572892051035836680117683941096946357/332896686858380698548283516637893649246850142918248278670743563011740786326889841348382607332659057310550456714403432663657161447004841164093440405789825610138255360000, 80617717509844610018345599428153693354517730846165468189557501453266279251161907958452608265043787519345683926836399434174520400296400022557633230406768087192357/38616015675572161031600887929995663312634616578516800325806253309361931213919221596412382450588450648023852978870798188984230727852561575034839087071619770776037621760000, -1372086450652244294704340588215279668156266232794489353398052542113302318878749385348011542439325660302642458824429630621603/7880410566204351067960504468577977224527474921870064521122478798332521541067824797589219596195469197977683933767224965403818143656917647175355254788063232, -5194606574390894898536760964842444987730693387278160672626121125112180905404788038174902448165760080079048149272644212670608820574956342789852021768375717/452856924612676623412150388521386425938580267596828974643567094818485918166798264335448710603579728961720763895191835408859071299518735048255454159297539295150080000, -100074540839561202126880325440628805443565482219698794998117969632645556859630922752672451981197076189068607/27282180753141638498762343789465785271976575119598381803192727958060746276351135185827300293080934056224035869855711576144692650332274032640, 103892131485797883434180649964887969860651944631424329611679744891646859608831359172124979720242092718788985623133186145896259217621442334564988761651137/2173713238140847792378321864902654844505185284464779078289122055128732407200631668810153810897182699016259666696920809962523542237689928231626179964628188616720384000, 280310997982068727597601213550722659956087130163400112889166253005985123769/11970980974379727427064432402033445169638548769598616372440423471191160110180279753868755507940813152572145664, -883436492056642460314754757333856701785159450664528364946693004206785233700924978913533073224295436248355531226319156956291201742191706139249761090137/5656090568631797827106857913777316177028798444270598622078838000590069018736337505577441038558995798460675663344028638167790849700111547949639549907961103033303040000, 800437948067543198362638326194839899901316957247866085/6119441851889849355356295546111882110884470715247706610529180008136014978304105957705071460352, 29447883012781767770946257699226118876774533977080761525079367874197373678355132000910762015122910440871618492164065745388010160070759357121255445109/71643813869336105810020200241179338242364780294094249212998614674140874237326941737314253155080613447168558402357696083458684096201412940695434298834173971755171840000, 29051127037957732911137173138843277571653691064713349/3059720925944924677678147773055941055442235357623853305264590004068007489152052978852535730176, -8588965718179816137065858979835251866431197640327331936571665127554201693285944527099475665894453487493477161354322711348578289378207836283605978121/9654003918893040257900221982498915828158654144629200081451563327340482803479805399103095612647112662005963244717699547246057681963140393758709771767904942694009405440000, 20937807485272196675/713829107112149030577778844144559868266803113126351186746671104, 609655256541553791435277229844321217039167401637327773492965655059435861541573759569812899255000404352381857188310582539632774878891/378259707177808851262104214491742906777318796249763097013878982319961033971255590284282540617382521502928828820826798339383270895532047064417052229827035136, -7734672412206435007/7138291071121490305777788441445598682668031131263511867466711040, -473424984400155690480621210481803697888231471122218983656518559896245840372276801777771428768514777095611625155091/190928640451368418850412294201695488967082485710032531388437600203641874002089453286385323430492753684444149316590733562736947764310065545216, -72003319858854613/4282974642672894183466673064867359209600818678758107120480026624, 640226502843090617113531456667170294184558246179478986205245777496500776600684632055117402090809/195201498624564012065683349230675141898068027746818605323605509085545166130056449553975485084524386492119168217110688852606976, 0, -50608881028718876109224256549599743963763687620465259639204716686606007/13426791167266344332120207330758387858565012558467100841537917203606700252642404780195640858282022666240, 0, 29515042188714725113439349922614601603121599535418377/7781272699851798191523609855794120929571114495910271467245966603769957196940238898855936, 0, -7255710288057879297363827181724969/2182019374613695894725882069865812401090394157780867760433988280824889344, 0, 3789648413623927/1675309007915310089924076072266338324334522357136098328576]);
        else % Pares e impares
            p=vpa([897879828766093751152256217580604308767438520319853766014869325702481094776059717702733540559250821170139373791432552824876736517617740064887072498630399974583428839/897879828766093773986255764741342617946303398868043162337384982081518117883166424767773029450066281808590331539964615629283638575440884836189524904009016247582720000, 107917730038509895106337532353861656887023431200497025051921805385762534345169850007415868659847129689418745804945055643296268322201280327/2528180822057989624628357708634797103322859438793335399111291729495443514061422773874696377531068636332683912835192675449403198508816448239923065541099520, -120350007685406254941517186030422780550226939383499233717095643817842464780710888671967878229910661093227701039546300827561802759467496985605841194949203463023437/240700015370812516004281186932804776563423858458804462942773241213642265057527763992586213470835783266702371353391249594247298944090310732740758054843103313920000, -45461666299211579555528724911184515560016011311837338532614316910059786345312220322253181895248037541034882310738644972652326633743683929/6390162923400249510779396781935378707847300971214772378268430382456314029107456459701668233649300321612941875272775604306855510936806280018187895439360000, 2455140156782287600806950598025938777363806323513886793985475252000973868480654754083877400660549290762692478201687102279578123929344479973516672608306119568406179/58923363762774903917848034561150609302726160550715332528390889449099626486082796625385105057660599743688740507310177900671738781513308067374937571825591691247616000, 1468411820555639147245391093695451215171963787777720978531569512383449111122533957510953607104912409067152725690300261872080757430008518171/4128045248516561183963490321130254645269356427404742956361406027066778862803416872967277678937448007761960451426213040382228660065176856891749380453826560000, -2131198052762402431256033608281021243768721372927078462562311063052292628614678994224984028043252403461410190581918226496771176907786199175606290863109774364393/1534462597988929789527292566696630450591827097674878451260179412736969439741739495452737110876578118325227617377869216163326530768575730921222332599624783626240000, -34962185348424435926791482203683207521148060739404522265656411242097756420752253503346449037386507201837781001800116568533925721340134341/4128045248516561183963490321130254645269356427404742956361406027066778862803416872967277678937448007761960451426213040382228660065176856891749380453826560000, 562074211717556685166427541258740052498669213713072017047944976784333434144584978550712235286651286379193906626319107909524051382305271123783482712346718235497/22662832216451886122249244061981003577971600211813589433996495941961394802339537163609655791407922978341823272042376115642976454428195410528822143009842958172160000, 971170878147948889203416809441499216467832123107656241681691398558193226934780087024408671216728672096407796229174101429368692296423537/8256090497033122367926980642260509290538712854809485912722812054133557725606833745934555357874896015523920902852426080764457320130353713783498760907653120000, -54125664832061014127141542233487415472586076980333718763846169438682001761473112898789168766455301099265984830820917487894418412720030241160201117660330167081/196411212542583013059493448537168697675753868502384441761302964830332088286942655417950350192201999145629135024367259668905795938377693557916458572751972304158720000, -6897257937617408836493788925860519923084730091167402679271467616503875512530240212341198056422491016905906991425775366891306020281/6450070700807126849942953626766022883233369417819910869314696917291841973130338864011371373339762512128063205353457875597232281351838838893358406959104000, 4271280368691683564338895473335689304794456070423957769598821432027339665707440615458282164483499424542640930054206597369270785589162762938481039367104493/2045950130651906386036390088928840600789102796899837935013572550315959252988985993936982814502104157766970156503825621551102041024767641228296443466166378168320000, 4425738885335828614304589374275635240245303890484595477282466309767626295972381851481591360022249713538475328322303004576420261/646623629153596676686010388648222845436929264944351966848591169653317491040635475088859285547845865877500070712126102816765140987653016430411870371840000, -190537033609327245368963684067307134420934409490477113130543285718219542733195243029688985663353459365318751318288788643575018926849308343788174667/16610693000378118053295076389363597940979747317271194995130652457695224401283200496359924558624110917374565560824754986721151472954336865067682051999662080000, -3330208194407835125373390597721131030664899000571454765761348520029341470419824959334403299174147850101447209393790116111246591/108632769697804241683249745292901438033404116510651130430563316501757338494826759814928359972038105467420011879637185273216543685925706760309194222469120000, 7926340598148013444092336792968557267624963534506557596425247142836753185843807038187352432831930580822875769842477707353484452939732926632402362459/165841158915775130644098042671406161842741797215635610831384434137629120422411473755657486793303123399067662559274353787423976305976099260835737607164626206720000, -19603194613177257464409319495218999326568862110307149721371197096640073018156838935533731914551130773948028405559519245713299/116420676264313493965094441841895418677347792053277611262058436523076415090217270591822753125449523808098474269752462291756923845513263969185363562332160000, -193251732678656363146314573768852282935482685449993053315296142384553633074292290335840051617562515349960684742670121332561634603109817694128573848407/1237269811888205774679625168638787913725049659684193448579745812629077597848573829345065227184780330913272801356506264599204248371899401113983651542366491288535040000, 1441396926334175346957781835638581128293015923572469606462606926355758326778093742147453249965447530427557770061513557967567/43758988969782180666445280422747212802855289665242823885238921032260678628475143663752508729109179709609187394000436370097330723672268131026411652015718400, 5920702594321622529558268136603104273975360591314056821011842858611705050536665194373873787231322674293297210558313683848410832723517651479157949/14404489231541611347373087134887849485769573243872350197925962279382643602403739434777107424332614146661876976576972443250539656290495478655446923593727533383680000, -2539016721133712657951595077569869127868716154222994831852237849389942620188855388341500911933456163846406097434525206342421978317/811606720220344061256693905056777105297117628479191703164303316169545258658054184560350529900533777910063520434004893443469212398094291479773062192265932308480000, -35292639753755713994727472879825595508272731620849983210861236508600006647103841851503824996403160358621679434766117445887004859767679036768231190568286479759879999/39668952768402744025241278107656106815928051675308316800118477272463802052969900087365862634687467710069093611743682512582341103893233016132875160506208843099606164255632564535951360000, 4762320236135664380987378156263527515957952091139867687880873947890278264185603294931724043050856346815662537351066881494901/19505920840433051673404568861657148549600114306379365913262404059602835801343100915875963469799003520848818724884714156067142501156455480592687770815717965824, 2099763181008124886367597741591810056675354695747195473325140298403266899238549067775602977730855715405896276471513891876802571552675745728883/1302794709659741762839404109201248153071813873868808622487588843682416349146670197853237513251520376240338445319884950244560696250307014980495582477389114248987148288, -1299636764891513335543116319532318397983800920936622982103487513219014896305053273610033636610088432012669290520674909/80886579628885435560727555822538362584751879231683057711424877808755594313914698584780766535659063011170621181895540043229246872862333794766170567475200, -260472880479670414860915122183689229760850613937345235157437764178744878152487639793400011604590296204021857294166270793426856673/105046488504579487294260403202595484944909686776740808067704826831284201864501183195929126972590153486105046885680775845249408924732043667658254524985901056, 80381956922981690575914387148128237039797516417477466268599743354823454300042636561583571364182366371933/88893857492333618572225390839606838608331868363288529372855374490314928693937702211297116697570249825840403355401747335548749771403218124800, 26815141809019067994910320044878980445601141756653228806461920942899187903503528403363299188252485922945034652339/8175624049327735356232361637537749727285335399887666582444930998001435575120509788302452062859535663607876896685399504676720410802186650386432, -16141712049249074498353316116868534926934945736696101987431880083728032828849912434412053/366057510224183186624087284805190047832046617409055516073959496806316332963486792523741729069308332362475097502248321469644800, -101237745442277506772908990161517134138275128255797580922099454968328599/26853582334532688664240414661516775717130025116934201683075834407213400505284809560391281716564045332480, 144649670072370121002322876905580522257310271237/76286987253449005462866181129462341184668772297139348107946737298420411275681569177600, 435018042097198225664619709711584156808299920393179735860942196640209/114463394700945589504334696323390872369906265953167208746490988113779840790337144912004808590260541849600, -201477062825490969911178435165242672331971145871/2674812490574055687190661694794910676265442441062945415281751040735383199471107676569600, -42165318252223101757130322313290757954128112382143/12433698686652836444549896960095694802381267964491736086452285362988824501427661069877248, 2999620106448979912444849066723/795527896994576631194000421158213010682393828820000961850103986300911616, 3789648413623927/1675309007915310089924076072266338324334522357136098328576]);
        end
    case 21
         if formulacion==1 % Pares
            p=vpa([1023937217652903808210057416040244023617070356733479740505511843430565325124704630592599605788818985813703855516709724496546953754118917834801793238560560998009507326749877216333067553682300289215956597770035207939961012053/1023937217652903810372452935947266795666848060546755463912260156995347385790768414189740330600902599336741355423381785488974370582172085962147762687559130394722141301833070651758292980076253790126969488783252427385077760000, 4151145376323023977484047402329031905426967471642819297299839844361635226231635196322765836034026206327795891374261715290329943577964390229504462191503290543209375779868215536680431938103640219583779/18857510425107645174359341570362163486864451781736079793717457891330981021646651627994384421899956204451653295713947882755277991555002583136221296162547318102799435642092384503215229049737673968171688085091565537675182080000, -2095278936123071681610378859187613544648091476405579131869318664015887963871614362386100660980775468292057894035367941380301947760377566595835226242269479927776753299766271764361805383797044146344598601181341505856123009599/4190557872246143372079853682302702997080989284830239954159435086962440227032589250665418760422212489878145176825321751723395109234445018474715843591677181800622096809353863222936717566608371992927041796687014563927818240000, 1718787766624111187303089215083811401805566593146792698488294497776419714376449177180124584656752206441288741591371274669677490384692731773923089864902163772841813169634043898714358435521965954737523/18857510425107645174359341570362163486864451781736079793717457891330981021646651627994384421899956204451653295713947882755277991555002583136221296162547318102799435642092384503215229049737673968171688085091565537675182080000, 3142918404184607522346811553155599873727858323432317294645519209721480135758553229451382139558304274607940108669431635135539462286324895130482334669388775842892448181042167520273450161794445502263098280098112967382565213139/75430041700430580697437366281448653947457807126944319174869831565323924086586606511977537687599824817806613182855791531021111966220010332544885184650189272411197742568369538012860916198950695872686752340366262150700728320000, 387152058462317695831084092108911215568771808512447831878969632461936603007892847674175626030299260057318638377355534514929574304018056163084843544525690546850668701207644088208721221537397999682551/2357188803138455646794917696295270435858056472717009974214682236416372627705831453499298052737494525556456661964243485344409748944375322892027662020318414762849929455261548062901903631217209246021461010636445692209397760000, -6547746675384599003474713565687507404009753719946266125540357779919168261850065783525243756537642091428502104694093470216395850562318717086569642034254986673114622804125442509076470009207521877097989219131520498873658461/4714377606276911293589835392590540871716112945434019948429364472832745255411662906998596105474989051112913323928486970688819497888750645784055324040636829525699858910523096125803807262434418492042922021272891384418795520000, 822603296520388237952423913329545234647360390246047688484551224291759080636592509557308633734344256928785112406187375458219489108343901492525558695972178657322355791369741149797504631067917934799/34162156567223994881085763714424209215334151778507390930647568643715545329070021065207218155615862689224009593684688193397242738324280041913444377106063982070288832684949971926114545379959554290166101603426749162455040000, 93539238219779985564566871631052080056748622588138921027229276937859701592201628751239761352310602826488834274961095761880826354195275876526709960507107142368848522446685442914266256112599548405079457584140762920205619/3771502085021529034871868314072432697372890356347215958743491578266196204329330325598876884379991240890330659142789576551055598311000516627244259232509463620559887128418476900643045809947534793634337617018313107535036416000, -3849327040771243533507975863590450336386933946207630910323050781618884083240025542700892573071553164940198148124695959169623035333024168531593610705270674792951646190081775482143038304320584212653/14143132818830733880769506177771622615148338836302059845288093418498235766234988720995788316424967153338739971785460912066458493666251937352165972121910488577099576731569288377411421787303255476128766063818674153256386560000, -371187453253095173003405672712481346839170498820118416811833172222222804952706858427839075502758871826185178599027735074714872062618861847646811379410365776382471529293893608918033447448939157986270965447392243370087/1346965030364831798168524397883011677633175127266862842408389849380784358689046544856741744421425443175118092550996277339662713682500184509730092583039094150199959688720884607372516360695548140583692006077968966976798720000, -4037952667025340514156021201252054109149264614765111910370945976722656014224054554348565047993678994524918446296994742616881544677646061980512439501059608289877719517449736196844882277747863331/162564745044031423916890875606570374886762515359793791325150499063198112255574582999951589843965139693548735307878861058235155099612091233932942208297821707782753755535279176751855422842566154898031793836996254635130880000, 39368366254116146538684484027921951547199867372489597278960655715901527830309107970090172584123545730658537178733008992464861625522668931627715368899740491556057310344120151395162243777380662897181474745021333056331/18857510425107645174359341570362163486864451781736079793717457891330981021646651627994384421899956204451653295713947882755277991555002583136221296162547318102799435642092384503215229049737673968171688085091565537675182080000, -2520677044798339893093775810931980404218483537876000483304787937811090707491660566984049434919232107874180521603615694650745393437373594636342393427896579071043753129252673011603503/14477198536312196888009641160453486400451536169437091781059950828168408784674499172596324242974276786180742440549807946051234477161131286580818440098744088158002031199612239691479518740444021838821142880659177472, -96394699061027369364295471221939040082372537567381300596468072889402061571598387891271902422181210630762808279008683793033505283968816608948801847271177957120437021472927087570520677632487011523974569724511643/8403525144878629756844626368254083550296101507012513277057690682411310615707064005345091097103367292536387386681794956664562384828432523679243001854967610562744846542821918227814273195070264691698613228650430275256320000, -3225408015366088704821006475066609130523173395387361483824248664762212640591080690172268916954457153147007033774964195867861711533295147091375788111832669766500911/879305747424226172701894201325262372889695910979645804271124140014342088423213305727958584134880361926681234889989934874285482800669454383996680253890163896008804032230438573042868473626015825920, 101468104274763599845011533674664538935009913061372257125617899148232258742135487117309594197210942305323474386284536560863122392726225546244138619409063488734619847012584173547907023231663130989597916669017/2122995826074601201729168766716821107443225643876845459467206067135488997652310906613496698215587526535508392424874515367889444588235584929492968889676027931640803337133958289132026912438803711587018078816950806380544000, 27103136820130312794160450550917938509231893542612339240800034312641961166127576002569393194239696900286079878217609952874629348853/1157475548049732162424357022422596106232164832460985386207121346761043069004990443570092470744073866961993409647046486211047440199166244385090646030670848663408869376, -862824015941695121279237025113422352153776651997645152557673426394342886726266362800825569968869492930887666138309211952623714847732018975575153247193627738956661768911450137467883338313697195593489090767/5524121792336972514703449341967238595898189175393832573103444358362751983687135522310629163724232849658720817023908177742977636428572185275721500682320276760902090316011830242129253700733621902598873572431861792112640000, 1091658932357442480188747670360571468114962858850980078868771836143362342442923900388827026029968952001895476617/8743856640726169359197815467861397125349180334873302905461320978171599031859495526187975907354980695406393249045221701369273530313435070068072399241216, 1513726343754377781176203290359250014520252211700498864194453872732669143262603477854356166121777961540864063962941887663247750634991295983393012733597744073709483742089175188972551579983762783993449501/3682747861557981676468966227978159063932126116929221715402296238908501322458090348207086109149488566439147211349272118495318424285714790183814333788213517840601393544007886828086169133822414601732582381621241194741760000, 34372358760939655564765738380392774148491108553279422317515875072783065114062704282067276067739516814558457/3702931948359473189948256126988169307742453557964413991584410352133652893221130234128165968670940441307055300273244650495175125767970808893875945472, -182360148292950901368275687016666720767613286776299790718676183402900027529030046435466596160738542331513778822659832950283641774965889834955069850280015765131332628993069192636230259035935054633804941/204972939403343969286514582286545255292004910671044345583885411862293271974420126391243308933695176135344057562108129160383456429945680251480666262636383892421732996109699831556687272279757325740996609620560494974730240000, 119466745621103638540682637671880022306956801035298745071728074433398430806123/4589844610562606898688354524116383744070006215561824027665701615184401559145255050326297941853399663316579391447282745344, 186667558401676956926053463297024303452249163051983062619149355621151082445999770534567759466492460890043078594995923235091191446978084175054958088737524390062079151752581036536704498565599/115817588290497575104077129283627891203612289355496734248479606625347270277395993380770593943794214289445939524398463568409875817289050292646547520789952705264016249596897917531836149923552174710569143045273419776, -50795603607619124426296482493316442243754057207962755036037460638126812103197/45898446105626068986883545241163837440700062155618240276657016151844015591452550503262979418533996633165793914472827453440, -434868291626552862779018978855267787515349564977836723238192412337954105787536001717509250295669226676184630671730559546391841810651730509136512012393848270441084784139015/175378669097312038659560196789816480598456214820858417393507252380626377187767026905109941945598516180946567777047842596668747395211609168520783204953475184041137930317761482057750736321707054727168, -67171638568869744535325179673374124103424913239364611197080365920557915077/3934152523339377341732875306385471780631433899052992023713458527300915622124504328851112521588628282842782335526242353152, 2685368506630480163132012075786593781157243983100279757695339021171156865309743012258536480399291208573897624450662414057250892619445943785519284055779/818737575688630431396658482156251564821949419114192163102648400437640186880597208576261087044761334383723598153811451981415906050866181269368435805224158398016178888216374612590592, -66149690713686140426499776138808334623593991316750711/65259019461582075079470134881992633754640741673369037742698709629477413048968130626018419725562328121344, -151681702715535951176093602458790699064680548515292061495426733814526942821738102111471330302478201975299721358605450778896061055763787/40234013685629715379380937963039740693266990655820856877492475058139638307344170256843692206416162566954631649297677938956554819484846149666330921259366621669847203840, -2125992760043023047/30331217365499435515545518893452454216250810324527903443371472694250831872, 545126528382229859217738950891914412452170316282548071981896288452987252366127687201928956056901610084487027944903/143439890210135382515890342603331190026233990455884668305585579956335185758460623806227902786411166568525931631637266461286783819222448176099615571968, -322120115158033795/242649738923995484124364151147619633730006482596223227546971781554006654976, -1498639982500729225168312238921566298381523780007386189176995043456379183776708960900676207639745/442456516773447322990891094507347626304958359851493689410400643686038197315649084909831693312518650280431262074984114583553117773627392, -11368945240871781/1698548172467968388870549058033337436110045378173562592828802470878046584832, 6391229076299809854252018383286915046270487226918248690315088117688877833351757/2377962257117140003271413547167592256837066357404181478340452760748568977956687008177581306483181930546545827616103858176, 0, -2385883183547615295638997202659543478813008135178999/1250273787877897440780978573087993910891172449632034428809984212827036886216728124520961253834752, 0, 2734553050587884465359050561478769/2272717657980986649752145516823023095965948559402808773232190631035017326814560256, 0, -3789648413623927/6327585028365136641526777513449406013302674063196638944852361347072]);
        else % Pares e impares
            p=vpa([26134561249924819061102467338926448351271206552155621824023194038580584460083604373215943788790566958987776016646169756937309968120299155372452407088453215965863545334729854985490343286421444598009093111555620407/26134561249924819725731007403286866176896245980690831830887858317016009992008845338457065021724468158696120227512365621120023108135990032261278103552741117895735266477197187630081633895471617202734186742415360000, 12105827677363344576965365523447746073822375740948293886541495127497486649371775018056381389008351279594011657427587200038529934726521477678301521698372446160204454820400893436833261/283602345584130267068489803621144801709540957439532551497432245432337563176257943682650279333691363046498228358911742974893874958256890564149510633764596803025666709020473251527235653033059344711680, -56048385033539746760942791474356517801693444027817136086573625155734938174918826808116490314220172341963211750673301891908705919181783973495941581254995858719870040488322609579067994296034828657313148138818271/112096770067079496372620742538607881886197133495610185549151353075436317367684998387989862225533870778721103917026078031764804998132310187395187944160041559601805677291899701844712890483027769864668693135360000, -1854446641752973970033404405528586250670657324378934274627712696805501722876280058688598343365835831522935536888306270802609140128943571661661464184040968806644068936511551607673829/260663920573649142526185481269434560394798674117217418655728166757663201448766492355377094975819267505972636359293881410748046836633171474402123744268930885133884842849699679712532769331856015360000, 71461690917763177120202059129777770063810572656164230139237099642051817589667245991413888379013795896693952058818930072627876174840897725586528697616637138506703878355321788484914694644907071979901468819077327/1715080582026316294501097360840700592858816142482835838902015702054175655725580475336244892050668222914432889930498993886001516471424345867146375545648635861907626862566065438224107224390324878929431004971008000, 71993541500724823253064975258957147165362666121599246950904728226295152601008702734111165031460942933957553808876366167705786318836506234707594359851254494491054169214972382391953/202390496022328540951821900120258084152692239759281793812019706400781764586422060170160580954782748568339330634740201191518315212097390351518956657208809317063088471731858164776798280034109358080000, -992523484968933015558361932371130147700734454240255911343001546500996199910869720619929811031742521207920558554412133937395695686897841714679065947476529063288305004827455746994467672364884829076548288646619/714616909177631789375457233683625247024506726034514932875839875855906523218991864723435371687778426214347037471041247452500631863093477444644323144020264942461511192735860599260044676829302032887262918737920000, -11141857612771058793976496254567592995840846079534093308186150513196315614850623701408614140536383650874397006253390819284808497052986308982029642141671786612652947336580647982147/1315538224145135516186842350781677546992499558435331659778128091605081469811743391106043776206087865694205649125811307744869048878633037284873218271857260560910075066257078071049188820221710827520000, 4090069306190658031147096038624881054045063489612361433038727411179214360485521357675075846872322457011618149722987244768764404348408724742213925921585180806069316693252220956162242989769077599202816712459/164911594425607336009720900080836595467193859854118830663655355966747659204382738013100470389487329126387777877932595565961684276098494794917920725543138063644964121400583215213856463883685084512445288939520000, 2475968356693711504688993977422337244786991253165490709020821013500618248471088316103631876164205833250134089594124048602523733191538707266907187123200318531067701108611649422507/21048611586322168258989477612506840751879992934965306556450049465681303516987894257696700419297405851107290386012980923917904782058128596557971492349716168974561201060113249136787021123547373240320000, -1575434103125290500886288770820811507834038308373145433595778806845510677696532025301225061479119605562311610465493233381751027865286640927679191784091473030744833592258915234922852651433482540021608320303/5716935273421054315003657869469001976196053808276119463006719006847252185751934917787482973502227409714776299768329979620005054904747819557154585152162119539692089541886884794080357414634416263098103349903360000, -72028170956648410261957265122928999138358306565020577181134772152584009889892737273638719643875016236951132847907895563391347758966194269696518854615522316372186337171498462361/67355557076230938428766328360021890406015977391888980980640158290180171254361261624629441341751698723543329235241538956537295302586011508985508775519091740718595843392362397237718467595351594369024000, 837551357323386762831625443908797238629682992013437431024124999529313482524595138021817451841741927476930438851611092065376778287568388292001893008414266167828529250139405479461998310951162880131643683/401188440240073987017800552243438735171652898826394348281173263638403662158030520546490033228226484892265003492514384534737196835420899618045935800151727686995936108202588406602130344886625702673551112273920000, 5785952746026774864006845846824009271176918858096807450529016482054697039920858604863117173039053358179933747868115950338318751705030527102603755423802437125256064656002927/844054599952768651989552986967692862230776659046227831837595968548623699929339118103125831350271913828863774877713520758612723090050269536159257838585109532814484253037122772402487062598390906880000, -431608458215386834716439640167203629457018545973578618837465625725427580367796075442039510719457772563243797434907691745339745379605147712443602730533489969701016086324522872356454473903876433211529/37626887854684026754446123369602645668094142711813209135379475158188414221320838619744848858920460121528762153966795423249724754617838384580202946291482481544662045524553746073749781420876454220308372520960000, -4628755265044778533425766363921683713126962002235281211530266529349378771950169456722406406819129455304766762521722705537435729573109530573567765240005943694865753419111737/141801172792065133534244901810572400854770478719766275748716122716168781588128971841325139666845681523249114179455871487446937479128445282074755316882298401512833354510236625763617826516529672355840000, 14765552517894812766615369712215229809487874228607847436798308416039149030348068557759001464849203652333069268868388370528782732794987924967005056687824477498496800121731198130178068773559122297263/308936552912142535457557644508316459169615066475940032901010427614599611501371096035799811683767988366236152422043162422471424301072778315500613664287961427419330479043704441447629784297722466229900321751040000, 40263767087054400884476614633346448778415644367946134994748723614237292866176543646855324008398547552446346790950041180082826088492667643330764686054116299662542757757/335524809919113004517586280533741262004780783720239635016187217311254141586818034525466168983959021646256407404805374711498225327721846275243431687387869627951099330399850046172417217430416261120000, -244564016859541412283900877185552365405769642310260955401451819338606480715070468264432672281039058316417886493902506589976767317389218948579939498257236011441779456477911804923974984814588326067/1565790230908747260455695887694324414176434125741410353088350987164678776305085803510637554869283717433842859480665966066687467265064516182909942546950164750150147024221508224976806857061748648718004115210240000, -14371013265327086831993500919675362464371077973379246953969313568266531096347378731817243913808198018469292158018380441166407781815845749032104209568953290844200385749/41054815741702667232771857286108580818904976696008521740580667910205056764563054704536040436877225888635934010051985649698922851100045110238786301268779727676096514067725651649656970724785733710643200, 11029357623077357809592145352815500753149152614241611494194632047659058359238379920674241183941500396988418586646284057018042625916872377430233989570907396377027371809873855483235136929052054943/26833346310083237365456435408722343882160851488195934286259191427096651970404803769966612214818705275238797238943177536123232282150321316546339015412440078267278990179796042914308415550430751352539913660661760000, 8309978028840633787325224092797870369181481710582179782492029818678030092427069037439954774360676068054536878211087597164609973948995529940678027027010261595456629257/11245449529248991459411421778368872137352232747167551607202530775403993809423793245155524119666370569495929750579456938830574520083925399761058856434491838450409045157681374147514735459397831407697920000, -89327113647203975717893261592651860755779745036547790245468732402878516526417162946550569331763616495105725104786843126966718041275210865851474572930273829222787867189745964340935901396883758925516430303579363/100403740749730343637508842133030347217201785175708254926273541485393039172601908171810141905871738398823105018824232878523158261978325572128270384583853806999062837132397783637812502021505996423696410789524422647381200543416320000, 26967410249927636419494265781438769985355628696840108990951988661681624611538166451635623719083379241029294701696718935389678037401067733175024880782183001419581241081137307/57268081922692105410561374822780200959636927034597157919601196282896006551463780778689575982236598851411371954121810015849719064761566518744418252281539216377664349671268673026375458212817487431242913399816847360, 1285833531766673578788059385614329899591500217092479856846526137402740820916348963598797658195103278136442650416749869897297231017256008580375796800197155890704243079642300303948886656787161301411773/797793359679639022587818657935992578433314349454137237783704081435849711284768459492199397961007869320969716131779774516248717127017715869349648077508442852849232303212794429880830425203098202507655533130612373360073506816, -1467120677395363337888354553663973499006606642304606621204527167216545668024533440991600095714176939792063791289308677108551414377564633680318227736548975396099/5661907198070675748202056168942084441541388546137519418453823293082953884874850172497620903991984505453848852135948831819173045603467956215373613000052070000548891983130331564732276719431579808563200, -79365259426611551138134403561619684025336877848920299044315500147875479928581950175976614414844919063833689457588171733656932288628936374475615099455291217468638035421768051716961/32007331436850048418663929549929769868881396431349373554467973637950243900129670571219067557916239347344566242568457577291660304498517199091446020891798650965842131194164601526085822721341722176986229506048, 2940152846596774944138945086636010330552966896640527120433909127516677905005129393412274203167344602856824807950197629385046499646111515784455227/200342471418347472838312166114953282217903907455558766979008731851533996343319194385730457464368186682734513246357720554651686846497949073212300973960208362090112740607029388640465715200, 24360159863548577684038781261307484606731588058435255280007683300160121715240052297308596257650894386147711365839908714926388534906219581257801844317307466960282913/7427128815271865264078041026435629164193287600778231250348437115506836060445131487393718320316038295410686168129292304377686104151950458260850786218661386066236769035041638808341691320556847104, -27090727724312486620676373805997282617846072047224669807647041074710847902469988538248310416164914679626143211889169167703434848087/37949707032914961438124308624435101899677999436682232742961082304558605635530159951061929338653717486077593969638834274874865446173915286803976417469764247436984151388979200, -592506772867915455024501649333715470000176691771656963632942967775181041258454280817862005987632939841655737497350403081357317627297/157164115959491075700706788918123987083074182249300222177704980695857962138063165065795672681313135027166529880069054449049042263612680272134105161169400865897840640, 30557632061356259718957024707474612128887537512486426794726549742412190903706318212800917624547106271/1008208356672326949413931730672167782553226775613546415256992839271856822006959193815654087855754336925113675571431116665769330128921897520332800, 7468172031381018159805109253875829242787418948090518777116420655334527022281441210183615789990666524611321274351290408333/1965106356085602129347844889839925686503158099947231558249378548662363145409279388494013682160692421044679090879310921836051661925791693562755029218308915200, -7432546447734487726101704536001176123764181391631488161493202440582000610544961714083984523/6554713355808136868118618458461457710903980038299014770554346962092024133038894051318912410038177133373051753011406432439807526096076800, -691592103270953102700054109253452012276674014223906618798981000588100719722480405748836107256751389375/204180668762342987972778362242698205679772895726753845037253651969174951344284083921718925168582040936219986063948872454752418923319828414464, 81819278576803240369288402505652964075764135482617630497103027033334947586501040418587/2168448937488014447262978615569773914535949978042262722040531875818696302739776842213129242618872049057321742746543359201254991462400, 409119417232751538915823804005129730153635790670200709578829516311995138816963149/152189584455496960209370467018725904437572246873867614613788976687908414589227968523365203614923643554978932967430646923264, -398889127247629815934655122433334948552262451/352127805070346022183265954228475534080716573221981835007921663825222968985305671517276733440, -38466490177450747098251185327902190014590319649115579115784293142253/20118270199812025883401115924318129307560362114128291194846203223059705767586480280051104937473850798877431562240, 24429953360343500574828830195983310239951660361/761885589488093754987248547472558834745794273869069403286171484922550272094324832826596010229760, 35935150843964781592312796625673096816634333856395/29284977345948603961819395452805701260420435517056932247965606421266007142696018951533541046878208, -6783032938508132408230213407303/5823838998576277894515808614037956587989148592881821649990359542237297846689726464, -3789648413623927/6327585028365136641526777513449406013302674063196638944852361347072]);
         end
    otherwise
        if m>21 
            if formulacion==1 % Pares
                p=vpa([3333601276931874369455819847967555325774860101352906325724283430537546457559017845093394208885605911255660459860751443006870383678263742723400759074166041574424641971613694939483615474548827438443934958270816373601260377213545500397284139295407009090910559133486358824060597949420814107125041/3333601276931874376495032037474716916699228682480637667687345527746752496578245905259532980583899795140562662165878658461343280811449950838523394943640157552953583517073622787794061608872814837758322505693724300281501554912421404180408373257400629959657927563998460721498480665655215390720000, 13514757827502000799168047907233390787770414239351869904434620736008856020982417585335318993449098374070289313470768198963221264430910733690086219524813747254800296742755777460635379641957940768895034158429276781114025286149032839741391535031212554844115527505644412613/61393823516828686433783506690159369882544128235685077046575280136002691811982695421863065725753487893838695694888265293329738754944203261276139190212039568266895163106105886341873967963407673262049106146526089196850986969637094193655854207490461601757033499303638318287597018925816883445760000, -6821535946314298478238294113632889094834146449469904403632449413416850824303546976044726622000580748373388274324740896245582285198748195906334201148726716875771509489717700198284348291658797140329793838271509210463636555553874983528047489578047805308074724144291710036624373668259303512425953/13643071892628596985285223708924304418343139607930017121461173363556153735996154538191792383500775087519710154419614509628830834432045169172475375602675459614865591801356863631527548436312816280455356921450242043744663771030465376367967601664547022612674110956364070730577115316848196321280000, 5595805089191701424838030911955647302770329499579949003264965948179746362686252405517287895631437059167487492174949767371819333488701677679579770416063674187026716146778337575708622285226756216791200411772142946630596916152156738493280435113620314870367184948784037281/61393823516828686433783506690159369882544128235685077046575280136002691811982695421863065725753487893838695694888265293329738754944203261276139190212039568266895163106105886341873967963407673262049106146526089196850986969637094193655854207490461601757033499303638318287597018925816883445760000, 10232303919471447717357465045041894559276497466955244355690548635972934228318095899396589297240316178907662124419161412657814329632966652420380395877326122340574572373931082523565440460732057134995373426875471622927450163393613502140096530868423598468835087263931633041508076748006846209695433/245575294067314745735134026760637479530176512942740308186301120544010767247930781687452262903013951575354782779553061173318955019776813045104556760848158273067580652424423545367495871853630693048196424586104356787403947878548376774623416829961846407028133997214553273150388075703267533783040000, 5041756757006095752808320983936961281996634952664847757177422200825268487550897134766984977265018009374771184401141699690594077181665791069688625394903876568126877242114431260431590028374655867474409938952770866911159063704539452074385429628782397002656009093382631113/30696911758414343216891753345079684941272064117842538523287640068001345905991347710931532862876743946919347847444132646664869377472101630638069595106019784133447581553052943170936983981703836631024553073263044598425493484818547096827927103745230800878516749651819159143798509462908441722880000, -4487852596259406893577443030898673169800738623133619238585762420346968392179195646375427670524783944527945246867173299928638781204945554510451320237661886879155595698647126908216841609946524632957696331917276839802671130763753285420520051798706411078324135965330734716307353099003919624297/3231253869306772970199131931061019467502322538720267212977646322947510095367510285361213985565973047044141878678329752280512566049694908488217852116423135171941850689795046649572314103337245961160479270869794168255315103665110220718729168815287452724054394700191490436189316785569309655040000, 10712498197820358481204443930976717174901774050065004967909885082521784911253694262099742447080463639491483578807613456378009744632867388959125224943986044227529411434246304146363520826013369606228009344749884580424441086289462956298572519071250208479715854163317637/444882779107454249520170338334488187554667595910761427873733914029005013130309387114949751635894839810425331122378734009635788079305820733885066595739417161354312776131202074941115709879765748275718160482073110122108601229254305751129378315148272476500242748577089262953601586418962923520000, 1218131418984696156828097149598753632722073992931386401490547350434517187122250832530700482175922126017958696683949868907708978647478517820140854167654906213783740248920829984308832687692825418509806952262573928170401488171628392299132085428198366089270368468296389502922492340737014725497/49115058813462949147026805352127495906035302588548061637260224108802153449586156337490452580602790315070956555910612234663791003955362609020911352169631654613516130484884709073499174370726138609639284917220871357480789575709675354924683365992369281405626799442910654630077615140653506756608000, -50128548186203948989168532717781204686130988773336622059534075294707571267069362564642784370815561974418051092078981717696957849275069676861665201535930438068738359622138813114122502774872514933098415147620977503023488884143407766353404630005181160738364606640346089/184181470550486059301350520070478109647632384707055231139725840408008075435948086265589197177260463681516087084664795879989216264832609783828417570636118704800685489318317659025621903890223019786147318439578267590552960908911282580967562622471384805271100497910914954862791056777450650337280000, -254413412486360935009561471679648285377116836013983508467755953690463793913715647014389619880489763374984493653151869475960039492219342331878375407981308586407905686418556329132588807709966292301409899990067618584799043327537005736639850066346806138422557889288856149690032396902560049/923215391230506562914037694588862705000663582491504917993613235127860027247860081531775424447420870584040536765237072080146447442769973853776529176120895763411957339941441899877804029524927417474422648819941190930090029618602920205351191090082129349729827057197568696054090510162659901440000, -52584959056872631702163595109245250190025525545028870373116056923948415288715854499960231205860493656006410892587186429517408080362389981392118468649867421160247994636737088189062041568798449210614028155719429258885603123821175830419280533977649838112059356894203/2117028397132023670130465747936529995949797525368450932640526901241472131447679152478036749163913375649610196375457423907922026032558733147453075524553088560927419417451927115237033378048540457312038142983658248167275412746106696332960489913464193164035637907022010975434379962959202877440000, 512681573646757641749667484728283123270358287580986874980069292455902678031492035252764229011071760871428813908687375341067710543088469091362953124312278101589659779325133050937773861805475741384164594900917760006373123857984653027325542153495054615321309470839507266989970997312838203/245575294067314745735134026760637479530176512942740308186301120544010767247930781687452262903013951575354782779553061173318955019776813045104556760848158273067580652424423545367495871853630693048196424586104356787403947878548376774623416829961846407028133997214553273150388075703267533783040000, -87926696080080529257786591103928211591023886279433896559606565746497794078523897791022819966044134575329545368869630428483312479290404564496413793722337207970388925299744090015779660472226811242413365307751567673735426629532573946819042572148760270017/504996163286737604920431328224644814759556821875159843841379870242993180400000846092379023741097248738534528564066115943133491026633955064708955162435546594960387374003024217476517688746154334766627889970886124966309599691079501929456712631570814680727587995880783612907815855718400, -313829291815266621639033335123891997952022488198945695055444212818809582128638514402129388244106627270596801984796879984001251484125633756491181972309191805080732040782846517733416586811661494566302651576090168133532946839270320103710294315612096811464459028872694104321510858321/27359101388961090211133470004527348432506296005207253585817861023174105085553785838619904512367864480320274373836125353533751673326293788447477357491996242543179662703255742576592677345547091471501384200769201959381010236023660514106886901733717291335576425714633831678964803442877399040000, -332527322762484554766013092213097830396463109786233417515288810218010989375422734238984390710975310545502117383013004788458494409889516817891085112096859952456927257969805225752322090271235528081645967032780829275944524882644497489597/90653084853800413337292796894017549428392862898629660835084079665830817995562910244649512737567418298748267310002920797179457334873143529976130222327885615797730378016206967020179372169724763048589105335634523950121642110233271584864590166280650572305397225986457600, 6276585836305332419416158980023874074508856307482295697450540419468112150111306669291506821718451643858916349548889245538361995329722621398852113864778751403246384276753329159540597011073185376990343013253403379833277603076975234998499541108465136647625804979729534764717410021/131323686667013233013440656021731272476030220824994817211925732911235704410658172025375541659365749505537316994413401696962008031966210184547891315961581964207262380975627564367644851258626039063206644163692169405028849132913570467713057128321842998410766843430242392059031056525811515392000, 125740374014137090623930239122058966509025503691722139631537502260665451843071960163260627562556029402846832657393383816099245035902274849008252702988673391875371938222979522739031030561100569088987102009/5369910093436204300820445953495389962008035612376985593867407236290757059964980256494462467944652736640705397316141761387961707911760402220344288270191693580820824060946010535223700878029988749755381861636663751455012977059833491069337600, -53372328540011328977650462959218087953705964137302600581262044405624041707140257776536226179115756083667750418962983088891022713529507380528830500160749140623445882123339288180084153127913727418317334275819195431565739523697406002514368133275103493437659906449988689129798281/341709592858044636922728237607566066136609248065037534582051651962909230864467692515007786970798633917469549322198137068625633144401873439384819240512279600743386807640663560344382010928057550623649941446341869370228127845846535400681934364510918006068832092599100101786254279735529963520000, 53310786923045238174146622120164488868350593328969461501855478833121867312629645419813198896410116219485430646300439498693168682151845496141064276288232344196198056371701017745523607/427006624434196987799714469737355085374030546756477415105922918249344512328481015158403603509459091871349613271537222521477958380262516768849021181554669846727272365173074850543743582758840890160465055041469060947933921280, 13376523443611859130710564905754099511283504444033030732425038183337070286611944637139844188472803914958813042312127237182502012025856598463104321378650892003464936746114844518621989428365616695416026633860383962458167122969680608617079488865489794147158179783447796748249/32543770748385203516450308343577720584438976006194050912576347805991355320425494525238836854361774658806623744971251149392917442323987946608078022905931390546989219775301291461369715326481671487966661090127797082878869318652050990541136606143896952958936389771342866836786121879574282240000, 117500986732227898194761142829508379562675498377270031547862356489363526813798228895318159555340022673383756110512084401469459443919672199798756888032136465098155527100042050155127/12658299143306234816197069260988787115830945061950911514997714967865944041358132860426984293758668731364118970500115292138674655541378955598291141745691793875314398177067436280941015299175125202385327718620624336401203200, -1187408783943803909191931001392943590194291999781840446298994501201422355314466664958344326171312266596102911302148854202047519097247097803858405941236820626080473370767754349935463419766323650058294171435595638717852828585209417628562767658392228315394878170748303804279/1334648337322362748560511015003464562664002787732284283621201742087015039390928161344849254907684519431275993367136202028907364237917462201655199787218251484062938328393606224823347129639297244827154481446219330366325803687762917253388134945444817429500728245731267788860804759256888770560000, 58347872912968152665669973541874845875460175184972681975527590706251873444426526280223687130558235535409252930993140220953701144922551867457256462287/2241452638536240679036625048317578086976990136162433165619412378967354739246602853539724346606351363819211728431126357952674890784282162330103154653480902265653172647005724417553299244528435200, 13022740634057711235554070122856071944773445206983370313207751538753047718149940109201025620960690961976538304563697597070080939524875999282638483908638037922523827580283140904485857693888339367232280658381013717153377667873242493608619904118594124516598050493/8079938612587801678726901251594317036152909150002557501462077923887890886400013537478064379857555979816552457025057855090135856426143281035343282598968745519366197984048387479624283019938469356266046239534177999460953595057272030871307402105133034891641407934092537806525053691494400, -18720364283693869575521258563601792601956487399431797638160653655710085840811084013826349520733792149407963126936940191994759729180596255018361619/16916623687065967388955660742019457260203699140848552193354055690319658409408323422941315823444161236371409271178312135491885968183261602491344563422497375589835265260420561641911692411535360, -42473624466194521570121714934422912148666756159886900556857112722914828924922614076247912322556182527423499445551493549494556876595922570405712398362451479796642452812085297501037022134648224338557434713951363629003568176054340674609510801257/17129250070318138856265834679364662073324069756192722878601854800719400219860597921198629634445446362837472485567546218621690890012615705257406445376757627109902353548706357672565947400533606198013516981620944176516494975564525392251475794896421422099697419791766650880, -76536069876380919491695350325378523915731592099380116263248377081166953786895846561303708756298399259074083150447697412818788198220860088541040999/4482905277072481358073250096635156173953980272324866331238824757934709478493205707079448693212702727638423456862252715905349781568564324660206309306961804531306345294011448835106598489056870400, 483147707758848908778385522358729309622957258252502200022253238674983816525376021852361734384257082429072091267761840994414976830011788815693146605205727938219146579475998178845108447763595017459426190430072641777764442473/147306104821862448275164943416719369172569193834456548585926644065053045334261148944716847064717233848769667951273754531128783373815162241074768809686827585286067584838642212438867657582012428263953457991511508458323396495003541009539640504332635340800, -144194851047302754369234963551546339724142776507777434302272627231173545067333712413938607696335485981412514744849270220651473/143411719126008751708211003023581020758171441422429316279820065970907962387032640174215367892516874040799519575413485460901355472203864653264947821767951644684139719062611558400, -22222152473627608179645756399912339396497814667127072810551581046406134457970126485810370916247437265192716974987561879100668020641124236165775717972519663840605191396724572976249504567066411757102984629883/5894489494939808530933443631245044280948639316652502213643130467906543626056609026072467513684141369383315439133021895736036322497996298813976881920556921197276622586081462645739989454582104552238975383847854178798903448380577920162201600, -348361474389413832267217597884023236429958548109679946741064257444078285983242388997270162073/8865139626278221730819874522467778005798770354831825335218577561266593954179332811358049304024053360776243676518194389044078533274555060923767193600, 708127430144697986218573943856875375537518221984182395304308729358879487703315927148033469682078273722515270386801125244601736404336998065337917623594088547820749119043741123019102170849/186330163389467776494420859521754946345031511311917417500766364326986696288791715705485208804127603725679831245761697100281290929569098226406845606496583205844627941166432662055451745203857842979112024018095590231825711104, -1558817675724101074300517236964705990679352925057286684802327253534426539190438281275605899/1576024822449461641034644359549827201030892507525657837372191566447394480742992499796986542937609486360221098047679002496725072582143121942003056640, -2561566408918181184139222657716920518771951267372347869690643245776496519306051275810316292923444822903501966268627623287539149025714335902919262795833186348633507926103/756258422424548390430233294547194085188544840000192773488054411878429907456433213357635364807645471664357926242985058064285269070507031090024026903192354882006083790334641034324649652140694003895875770777600, -9572139481241494833462498321992016727382406052494909961760839441915389077000237352644653/4728074467348384923103933078649481603092677522576973512116574699342183442228977499390959628812828459080663294143037007490175217746429365826009169920, 9885615933875048500756824551121744131160517117445430700090971198639063399586504393109541894382328173074619378639884050097428507906047212447193049807017/3677383235098519734077592511950595313380402952021191850251479645166748490489523020453269342902715048383217089363899581541542627474491723630972091418614763258228272896787588627546761172562739200, 8009986817448538584527293253656906964141358433371157026194682876258181/220710628735231805267809532663261915386413595726837672611329146371500481932456087194812351092759237087659551397611579090581166489600, -2193582990829943792063400287989156072512088950349335836598014185251342365375525341943145773797393574524675003851702859786313288485691/1147293753008070013665688024188648166065371531379434530238560527767263699096261121393722943140134992326396156603307883687210843777630917226119582574143613157473117752500892467200, 2553403128430903756627282151485593020178070728562555093451541765300233/29354513621785830100618667844213834746393008231669410457306776467409564097016659596910042695336978532658720335882340019047295143116800, 8325414171713334460666937071054267147330904331281108917246552125406185184744820302930820381297513634614711047194911/6792846422147924100199750374306133583037100533673304918877458036556096968688283395731855038940432464689100703117406228471297108815982184416694296458686878072176640, 3169807737969491989468205954753513/1903595556527614555348267644849493270584668949355291112257881539870423890129643661282746248287014092800, -100952870108320226379793880679072932645389714175532765930591007165122778337791283623207338472458473/141842234020451547693117992359484448092780325677309205363497240980265503266869324981728788864384853772419898824291110224705256532392880974780275097600, -41686132549863197/9192095637929265943979960500972661075506896151055379256775813838068862518963860506935296, 29441426566230199489499799902537453209743689254616412323353052519308374978455141/78278702991428880268316447584570225990381355284451761219484737246425504258711092258426780520898609420423254229019573384126120381644800, 0, -30468507505669039036514276010087176166964183587869521/167979526990319203971562982273308883910723098790374824167831423883247291807682784689136474720422110455608115200, 0, 6729661142136270272793626567718113/85097352707130367547941251613922116335541111947087546240890690976549262857272192595127802265600, 0]);                
            else % Pares e impares
                p=vpa([40571926451283695072751757514587770596751197744247738960288801665400710011847708780660100645052537952511551261595037548898730057766459936678220048977535195030368301011424551280416269576637064199150725115513285260576808934899380642910385401007903109269102204704565718138904027/40571926451283696104537215362779506884512178207464087047366804421390103028778471280557042937672336399318393411332869731851010628379514834875849264263450026888768704712960590919216348391945818461626419784655800920076877594148170589481422085093854594169744014861449255976960000, 312425419802623772863914432383390650771105741509794585789274482394194639790263039174571311934999535005224761280134646964486336188195113876923061367270963544456661874457378392434801875762368446999170165655398424698919788060216324962551398868294717/7319167613942841571998614028600237082677996548115499933618330849286339722158578824714449004535414494077549244812585637725040735622768514925405153070444302930423597979847183036365645153388466581829555803589332246566532809719295332241553617638724668504243647283200, -21752717919652716414618742539968315843466258432960736064983496835248127861544587392066867002752945155422316634169874676386014859305211244868247864751729271209463999157986047468216463747645483881263170011972599122231661471637344365540892848770198988460152729888344912258589/43505435839305433935625077748078515347975681288641024713781806211662181556594561728538495797136390134073032150632672812952983210578523873181823659596223987166265461548824163056757726523226214649415584940654198290523612616274079982593436672128826923895252466916382474240000, -2392964306086287117556300050498544081806978155819607466043860937201523890115666947299220624296497785111308736780776466872534519923553948054508485739491423884193785261455207845652909116351190383707314140071946287610183096848552814303296023231173/336358805787814410477877482931996189461304988424425548419960057412056053408022923929891957929017210205769726324107795851334592629722817781498398578604977156729025642456212455715332957416749383356137674797303871625300221034894086959630221398838449839349432320000, 110938861390228853714555586953794613358342228889474220575393698500313059336221476914267432657074495871988982525502899890746674419106267216501313458838321685097703344586040633199260817706522168100269928151744047431102241047409263602317876149764463751613542401440378156959547/2662532673365492556860254758182405139296111694864830712483446540153725511263587177786555942784747076205269567618719576152722572487405661038727607967288908014575446246788038779073572863221444336544233798368036935380045092115973694934718324334284207742389450975282607423488000, 95129534875771834951330926678832192180789301068703827066215505927287918135585403032713678347435102427711988755292226453083239564320359417456929408025351552123144396402285357131800028500608024273481518419394545935595179918210094190194030317348739/267431124355603826669180127968085585713234489258066343728362088723923951386563457056874098242640144975910453175844475224568796109293464968428265208343157222457785310802108610944129342143040125105310692823456370547623314201281944831902920644491862887655056343040000, -3081635038617468158737655193199231157490410166334660026373225488040145630144048236643328253684875774499826079035398785760712075030409195590422461055093312868274944900211000300972575190370703770382573434296182389750110496520408899025956910707115383627446676197423020300593/2218777227804577130716878965152004282746759745720692260402872116794771259386322648155463285653955896837724639682266313460602143739504717532273006639407423345479538538990032315894644052684536947120194831973364112816704243429978079112265270278570173118657875812735506186240000, -29444856031835520724778850537342201317633643832966310424615736595594594120193878082509597374375524766376255346737828163358958152245192532115653379082627533652159352896981694201793024776023767311428921378933598060653686916254707273001649212871247/3476604616622849746699341663585112614272048360354862468468707153411011368025324941739363277154321884686835891285978177919394349420815044589567447708461043891951209040427411942273681447859521626369039006704932817119103084616665282814737968378394217539515732459520000, 6349522744404123953442971118684798043198636219329995474624745747222528677519726321925288405620663333474151431346073468154369708374189368296729237276658930410004277812558228399388680223269109225596398869930714377829693229661788240998017193992214383597931325756774685199/256012757054374284313486034440615878778472278352387568508023705784012068390729536325630379113917988096660535347953805399300247354558236638339193073777779616786100600652696036449382006078985032360022480612311243786542797318843624512953685032142712282922062593777173790720000, 204478166750568168062234399905465932131378480350026365207880859429350388079953693760472782627748477478339851988885054870497868453857521452792337420568712060192361829531875614814988884580203431167917529975717350941287763690837738080956104219301/1738302308311424873349670831792556307136024180177431234234353576705505684012662470869681638577160942343417945642989088959697174710407522294783723854230521945975604520213705971136840723929760813184519503352466408559551542308332641407368984189197108769757866229760000, -1222871047070423872514942527126995425431531480664348905842544265488904742833108656876411932148330690946438372366877866837848488660496692591028361603231316657942279770140453423482003341804374924202350056222833334275017975229599721830755521260493785581134670141584805679/4437554455609154261433757930304008565493519491441384520805744233589542518772645296310926571307911793675449279364532626921204287479009435064546013278814846690959077077980064631789288105369073894240389663946728225633408486859956158224530540557140346237315751625471012372480000, -2974227905802325992685046743802024882615098727016259713998211760321365666491162967661286448032216462957547215109603912188836568273303609809199468425174505830538917487126205027844395995184351954543915261450774478635403345383982505106758099779/2781283693298279797359473330868090091417638688283889974774965722728809094420259953391490621723457507749468713028782542335515479536652035671653958166768835113560967232341929553818945158287617301095231205363946253695282467693332226251790374702715374031612585967616000, 12352232798691150227423651015471266633116016927232540159050124907841944205433119786011932336316352038503359346887103165348285823681856267858384091885704725361761182581365503067994245447467414953168565077035220154067634850686892414303635712257956890319774321335395261/5916739274145539015245010573738678087324692655255179361074325644786056691696860395081235428410549058233932372486043502561605716638679246752728017705086462254612102770640086175719050807158765192320519551928970967511211315813274877632707387409520461649754335500628016496640000, 477833667317601813997710518840852451807978446277046651094039147000472372806012988913851601491283673676494478568577715322273537603546073592683116997423712469344313383159153760140985785383685957997354334292578340441534875633747021951829061/69706358228027062590462990748573686501695205220147618415412674755107997353891226902042371471765852324548088045834148930714673672597795380241953838766136218384986647427116028917768049079890157922186245748469830919681264854469479354681463025130711128611844259840000, -335019716899150177264102026875039672739773409524266497935296983693401451368450941079256415946273820573859330635485284668437568623082715043087220211858181547644607868143042804220302027650274917020627048398479531880910133780823780827741806209542909311088109769447/29206446437575675928811241005703059254585072753213555052608765009227758247783761719858011164511143027070007597627528601702702015493274768010175323924737781594136253906902934639501690533074941303104168911208412838393474203932249498803985458212359333524085572195613409280000, -191133364993049966139879810723378275455805654747574190107549526509316285968073400548895237591469429007351593744387343765491768089252529949727822460905095124049571686592154683543147050950336638523983859832163092688096694280607126786097933/5855334091154273257598891222880189666142397238492399946894664679429071777726863059771559203628331595262039395850068510180032588498214811940324122456355442344338878383877746429092516122710773265463644642871465797253226247775436265793242894110979734803394917826560000, 871051263937790460886619075266409962689508683965445508838507650493859303150201287185708655538228470318615046741521087625580747238495030759383264163913303503093888049075160192734710046223939016323873402399226305906763172968160096354903656905466968511653845633109/18224822577047221779578214387558708974861085398005258352827869365758121146617067313191398966654953248891684740919577847462486057667803455238349402129036375714741022437907431215049054892638763373137001400594049611157527903253723687253686925924512224119029397050062767390720000, 3325318283982600396190993688772650818438007252497395969874533196024538824480795901169468011159869414924914718842468182905590502986280392728346942955007091502056577723584352279412450978126451401936745384834177608713904285106263545501/27709359792507652209873487005644198360922317603040047071965286859173365407758003240563427168900711483050171645548978456930056615194154685313571712304551043333162394008294570501473013298838323646086457937279932787947831991838799246581451140424630510752534364160000, -225427345739593804576995772007915536788165328539638608173826381838681445974978786566831267853068905893698783392252318266972837569253283091112776848896974213282730357971720628107315436074719499767514045247701111324134606137832869874227386945036042515366290279/1443270110915230296208833748083065462294899620028366732910281580207553072169985144367641843632612757288006089731208804690352156740773254995583570665498222300390981590579625763924692235286610142903706632655739953678624104139658242313568374568556092282718166536573293690880000, -2377332819401028239415398478744744359049665104702576639603100861453921849549202208742539455611807344936413465784085640691931881610489186905525190883118308392579235001011747010961120208934293838918764745286357822016477139675957430393/6781034528422472648800239740021248222884909563815960319451345000176905982586538553030681896773382114132038005098746007979923454870313534589937269435169731324491501061709847293120475814491714562670277986411145151866593445042790951623412723084715578591360209597235200, 8561121076591384941169886853763586511253128746084869866043063635606033363511238360315821880005670458205448695972390653078648368515745634010233413585539266449679496873862215855079008099363948818895015945197242197454968778088461519512650704729581436486500149/20828368659482539176660816442924238828412669026291723831803279275152138453276648357933027390462803713019068275336660397099984065906061091700970745290327286531132597071894207102913205591587158140728001600678913841322889032289969928289927915342299684707462168057214591303680000, 11736177564148246191795930895926354679751586139491551391645430837128350668412811177223024455879479867409837133432178584991715574745712160175451173285435658078657811209324096669869124542092057934282365265528715796858398101368392571141/14859310444890983543457916647698735236234758348535843482623816869952872240102675785771581199886019937054552845955512991399484440237556614927514712153589324293668332761312013198837912219581844085155739587613987637133752592615507128774782662759550659174111067986984960000, -69336788368893036593226910086570597645897711135285765089611532460175893453336506268084904051630416280317411628561747440768597936517594936584105314950476047377656688128725185181611249643270077885800298248953144515657545906283074172004979462199533158402876971281716783864809/77934600588397739785476363893492937360811048975392475241490187357293706232486856056215896860597897942307964774478657116846727856510911931948638524056730886397119259422206433580141377550248440469816393292155319440909286638801494063506083100968964897669733740285500815006212153642577570037760000, -41346807194801173039909585826868547797603348583061996127409550570035961169013436485459844482212052155842106566203190615958036390357169776099699705510627670238986411790242107334527091622718880128525768522631004141127766866503578437926526319/11823729868181978407019080732567946376070394854124341487614814142420044731798979116959737555922089197214545012446557112521051066757931447770600962269192251729494523983228309591631761629747481378837620942791551405271711776331710201900515480820383889003268903401131607663522611200, 173277703691328405469832042220434493393140579727564052734033347155360233901474898401590602774291795377884602040029691613732457976831080178537736962896157507312876981700020116369560139176268002730946701764190564803021602531663780020558731800889832393987800538731/107509874311290551349158823507976068093586991420148658696394089195870862603951685434456013402532185134507549912647577039639660761325593111157903247636023365201528922033904073202514061355273890309143617508851548219167373339927763824313375305648723902610995913533712412559153791028428800, 76074215787973064522606753952653892109858174745379511106719729225086446727508635676055935087562598260456093331708257697509848978157665370873212362247675456399081630092439535917939717579837688061171034311457559926674774741/38965778144431688698258341393428806413236748816419299534906560550550618680288139424383777672342796622412938716241014827732412390352397476395712987441111834993830004061400862090477147231824854467054233514494103743343769388882523793626859855570385919195852098764800, -243174775155716522477573919704242064135989199225344846531018339787030192090798525989414466911254872168071070901325324776422093697869187103009719315103815188421426602261710895631228369573036336632321624189601403381722641962955892264559896288329/98070310381682721419175500902109680695783372930987632877207453905691918325026794574999803781822399717312714926284873975337283110382983197971275704477081888500516451686131134104024925351113479034532907538001996095224178733118507818445230389492898832803431317566075699200, -3609204761110530145372658819026276990812860224440015661331464915309761934450770189123589216617523548084697728718953378525845421743956480770236203603227084142881987224039015785707609045482936240996020387771/551510296520195858660128218702108476342620063656635810943006270952060836583856899389671440168031121829430777672250697303744495917278514601017448868155506259081724141985229058599654938025031798340925724006891515646012266564807121067797798425062277120, 51053358676252726649100097633049914537542455132744079901022524464543736095297024107481994158497511184214557355399162176016798916360207181263744399159967638360859417056793859481237418799298777196033376792382692905951413807135346829/15565574013670772085444419830822069704647057150475334642076355515527581532897058823827374961491460256760513675808378588919018203023657220017800112154722080181201656439210695294787947777736125981599135605442492624887799230475974209557575822197002443302528614400, 2983102749602902789745273941586658647441948111059198729403089641334667174526973885448395953213462661677157068049335409444912627884139865911804012118016570663453825580866088433133668160637453/1175280547564580774122079249662791272204861404824280698002104329272841413344045210246411526460812883685645628930532460536761901249142586926340876388639388660201762434040640475916965430786123381974335593766612083596497403663136985815449600, -165567938045474853986544153832436592571318295372014584149670417982921209749037762147535583924568111309996648918762515494204122506256369691609631110674874436286698452596246021089675101207137496978891/43917369059769872806470421189405353970443005238864587349020916729469177321021326080504562807710031936938430660464032707631858605876537403568453207020140597203944791749726702613681476224825565161101336656867371341577943029855027200, 149924187252752935858379191380311568472006633802461999462602060413631715092283838025420467313711572169238190064142319972944151917569570532649584980978633513669/20815754360744057799487461570109583231601692039089594331732273659456798824763877110220342126464708984621255284499840285949888876926721790543580681782617601049453791156414314428080973796375692343998276016537600, 1583876958343190846965095254094681794465099937419964969888746281025093050972903921858998705735558758162352973760268526373641305448641767024970513162602760272695208415195904183075987514321468749/416766869648836562891433158046050468488544824500780059491719422581900748849784388914825392092907219874791293516359426032188224194146632673330980758184045741990950133892217451754658357629556309422918490249525508941503230325555200, -2277755453773743835905093161376486918746541348080410211898804925750887844683797503823001777783021207905599261214639343956065320481549810347185355525828371321099/4940539236928906825777309291582924461426836926620465149510969972687767127839927680717398389380092097938247030067262895879294559561012809000744705972370913371703043913410032649785639281803868884743229800028569600, -11499347766871707518674034969098357959305143396210502875311320497336761204428487586109232157400340545433866557917235941835534318676198132643508852054530787911833171352095558629391/3394984628343330160331816691405603639881654586005094742262539412413391297185248332014169765105451841533064239430887965568605429783762728896506346224194853402717293661258538679538571900894826605594051330414348966297600, 5539284864264538661350596191565753774065947359299755952166370185354944180534971195459338287553068438221901587028273314648677581885339942004921177/358163271532866391401817532250928880311712978735879357736059182692634380940065971029381009779948192276904956183172343507358855696358818843885342801540927269358593222447674537113107845465061615206400, 60337012570174859217175432824246712513992513076940899207150342144068574799664834628910686126247039294861614422426615342012746711266623086460593419/22444966034536863611313430859073457723269060986457469789132566193644705142147967654133724016740204152729596492699582406869767013394114524114819893912443623402272173442307059494303962234880, -73313697608777371713744657240699619749959066381760576519237464516206981566065095046597503322165678546804914678564357/159871851019360167233281320089164527378046297733579880420402602731811735960591165084476208277258635790902770811663101557543442058961439819724222121596307577241777838489600, -1378795013826163122310369493811551584651205800903912071681057967193031156512228000224036140172344554803783612563117057050407771027386856284359977/721140977072926408990581638995126651565687958931197326028149292765264064574187448311532579906312847881306865864193445935902832033187240489833161870706549338692524928263440088005069965885440, 15911041504056616209209170497442838976938883734215725528779328107117038235951794929380717568024886035781323308277325177/1302244391176412577157149362928883455788480159197750009051776886384880632187848150057998299120738286544756554447787376574488664957939321450302856170265430381230668898946252800, 29333521867249353756610069043190871367803241035237506332847142052704390397684959111564779856804325193396595762986328014523023562157/23933668792056547494579490749723752199448231186617416495724656737627559263826103194392548331146870241814218431813595464880547844654590844255589563875441894384003275753515279974400, -62260373536794803242580858601034091013730352104556061437011637754064460962683642633596672600218280860173/211529542929476559716061978827132172546414279340608454305716704710527647369713794237434864984919090586918266499034507079505545830480934244466541287564347493580800, -448099634723730279466179703827104176831609713685070774237666998358682263364221529246715082285619974932572237743/629582716802458126994946974533242599608155318310883830273538623651074441182800009304108624530571615623793220537819847506752675815953251671889711453516975371714560, 248462533185611582059119972804792295808026437972543282790264039790893067854259373972636633/38500687546678446868886278637828583744961923320590643847219385392954101908533796439310599880154702404592244901574013074926759870370119386576558489600, 10351826867990692072419947931568860160435949977549859781852920934800694035676780557055331503069919/27517947471194243413866594524917426220427498817110303316705408591610394299911147180904675033528313880947247113901385507848978028512674174246505886515200, -1542667405076564118992619987466352586831571526108458041463921598509449118621/11835739892304047381208091229413914717840001390268494104452331923626300455827843807747748441187221812673339940760667911532569681303961600, -12211219761413364665986885743848534559533592824849413/67191810796127681588625192909323553564289239516149929667132569553298916723073113875654589888168844182243246080, 1255403249538801819971549648363/496401224124927152974826202961891752329573021441092807729250626794311585158084321247389286400, 91407630238448552529951127539283274761034511427877/1133369679664175206077632799151075722077083653202173090388227103972925187247546699398378654747668000415311462400, -58425012503609228106612016542043/912137249329553580070061324782764162706238607963231729314430823045547287170519637271043928752128]);
            end            
        end
end
p=double(p);
end

function [E,nProd] = polyvalm_paterson_stockmeyer(p,pA)
% [E,nProd] = polyvalm_paterson_stockmeyer(p,pA)
%
% Evalúa el polinomio E = p(1)*I + p(2)*A + p(3)*A^2 + ...+ p(m+1)*A^m en A
% de forma eficiente por Paterson-Stockmeyer.
% La función sólo es válida para m=1, 2, 4, 6, 9, 12, 16, 20, 25, 30, 36, 
% 42, ..., es decir m=k*k o m=k*(k+1), k=1, 2, 3,...
% En el caso de órdenes m=k*k, el valor de q sería igual a k.
% En el caso de órdenes m=k*(k+1), el valor de q puede ser k o k+1.

% Datos de entrada:
% - p:     Vector (de m+1 elementos) con los coeficientes del polinomio 
%          de menor a mayor grado.
% - pA:    Vector de celdas con las potencias de A, de modo que pA{i} 
%          contiene A^i, para i=1,2,3,...,q. El valor de q puede ser igual
%          a k o a k+1, de modo que m=k*k o m=k*(k+1). En realidad, se 
%          corresponde con q=floor(sqrt(m)) o con q=ceil(sqrt(m)).
%          Si m=k*k, entonces q=k. Si m=k*(k+1), q=k o k+1.
%          Ejemplo: si m=25, entonces q=5. Si m=30, entonces q=5 ó 6.
%
% Datos de salida:
% - E:     Valor del polinomio p evaluado en A.
% - nProd: Número de productos matriciales realizados.
n=size(pA{1},1);
I=eye(n);
m=length(p)-1;
c=m+1;
q=length(pA);
k=m/q;

E=zeros(n);
nProd=0;
for j=k:-1:1
    if j==k
        inic=q;
    else
        inic=q-1;
    end
    for i=inic:-1:1
        E=E+p(c)*pA{i};
        c=c-1;
    end
    E=E+p(c)*I;
    c=c-1;
    if j~=1
        E=E*pA{q}; 
        nProd=nProd+1;
    end
end
end
  
function gama=norm1pp(A,p,B)
%   gama=norm1pp(A,p,B)
%
%   Estimates the 1-norm of A^p*B, where A and B are square matrix of the 
%   same dimension.
%
%   Inputs:
%      A:  the input matrix A.
%      p:  power parameter.
%      B:  the input matrix B.
%
%   Outputs: 
%      gama: estimated 1-norm of A^p*B.
%
%   References: 
%   [1] FORTRAN Codes for Estimating the One-Norm of a Real or Complex
%       Matrix, with Applications to Condition Estimation.
%       ACM Transactions on Mathematical Software, Vol. 14, No. 4, 
%       pp. 381-396, 1988 (Algorithm 4.1).
%
%   [2] norm1pp function.
%
%   Revised version 1.0, 16/05/2013

n=size(A,1);
v=B*(ones(n,1)/n);
for i=1:p
    v=A*v;
end
gama=norm(v,1);
psi=sign(v);
x=B'*psi;
for i=1:p
    x=A'*x;
end
k=2;fin=0;
while fin==0
	[~,j]=max(abs(x));
    ej=zeros(n,1);
    ej(j)=1;
    v=B*ej;
    for i=1:p
        v=A*v;
    end
    gama1=gama;
    gama=norm(v,1);
    aux=max(abs(sign(v)-psi));
    if aux==0||(gama<=gama1)
        break
    end
    psi=sign(v);
    x=B'*psi;
	for i=1:p
        x=A'*x;
    end
    k=k+1;
    fin=norm(x,Inf)==x(j)||k>5;
end
for i=1:n
    x(i)=(1+(i-1)/(n-1))*(-1)^(i+1);
end
x=B*x;
for i=1:p
	x=A*x;
end
aux=2*norm(x,1)/(3*n);
if aux>gama
    gama=aux;
end
if isnan(gama)||isinf(gama)
    error('cosmber:NanInfEstimation','Nan or inf appeared in the norm estimation of high matrix powers, check matrix or try cosmber(A,0) (without estimation)')
end
end

function gama=norm1p(A,p)
%   gama=norm1p(A,p)
%
%   Estimates the 1-norm of A^p, where A is a square matrix.
%
%   Inputs:
%      A:  the input matrix
%      p:  power parameter
%
%   Outputs: 
%      gama: estimated 1-morm of A^p
%
%   References: 
%   [1] FORTRAN Codes for Estimating the One-Norm of a Real or Complex
%       Matrix, with Applications to Condition Estimation.
%       ACM Transactions on Mathematical Software, Vol. 14, No. 4, 
%       pp. 381-396, 1988 (Algorithm 4.1).
%
%   [2] norm1pp function.
%
%   Revised version 1.0: 16/05/2013

n=size(A,1);
v=A*(ones(n,1)/n);
for i=1:p-1
    v=A*v;
end
gama=norm(v,1);
psi=sign(v);
x=A'*psi;
for i=1:p-1
    x=A'*x;
end
k=2;fin=0;
while fin==0
	[~,j]=max(abs(x));
    ej=zeros(n,1);
    ej(j)=1;
    v=A*ej;
    for i=1:p-1
        v=A*v;
    end
    gama1=gama;
    gama=norm(v,1);
    aux=max(abs(sign(v)-psi));
    if aux==0||(gama<=gama1)
        break
    end
    psi=sign(v);
    x=A'*psi;
	for i=1:p-1
        x=A'*x;
    end
    k=k+1;
    fin=norm(x,Inf)==x(j)||k>5;
end
for i=1:n
    x(i)=(1+(i-1)/(n-1))*(-1)^(i+1);
end
x=A*x;
for i=1:p-1
	x=A*x;
end
aux=2*norm(x,1)/(3*n);
if aux>gama
    gama=aux;
end
if isnan(gama)||isinf(gama)
    error('cosmber:NanInfEstimation','Nan or inf appeared in the norm estimation of high matrix powers, check matrix or try cosmber(A,0) (without estimation)')
end
end