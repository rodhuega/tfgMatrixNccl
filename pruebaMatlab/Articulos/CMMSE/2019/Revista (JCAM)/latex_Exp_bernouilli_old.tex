%%
%% Copyright 2007, 2008, 2009 Elsevier Ltd
%%
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%%
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%%
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%%

%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%% SP 2008/03/01

\documentclass[preprint,10pt]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%\usepackage{hyperref}
\usepackage{algorithmicx}
\usepackage[ruled]{algorithm}
\usepackage{algpseudocode}
\usepackage{graphicx}
\usepackage{lineno}
%\usepackage{subfigure} % subfiguras
\usepackage[active]{srcltx}
\usepackage{subcaption}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{color} %red, green, blue, yellow, cyan, magenta, black, white
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}

\allowdisplaybreaks  %Esto es para que permita cambiar de pagina en una formula sin romperla

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}
\newcommand{\nvidia}{NVIDIA}

\newtheorem{Theorem}{\bf Theorem}[section]
\newtheorem{lemma}{\bf Lemma}%[section]
\newtheorem{definition}{\bf Definition}%[section]
\newtheorem{Corollary}{\bf Corollary}%[section]
\newtheorem{example}{\bf Example}%[section]
\newtheorem{remark}{\bf Remark}%[section]
\newtheorem{proposition}{\bf Proposition}%[section]
\newtheorem{observation}{\bf Note}%[section]
\newtheorem{note}{\bf Note}%[section]
\newproof{pf}{Proof}

\journal{Journal of Computational and Applied Mathematics}

\begin{document}

\lstset{language=Matlab,%
    %basicstyle=\color{red},
    breaklines=true,%
    morekeywords={matlab2tikz},
    keywordstyle=\color{blue},%
    morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},
    identifierstyle=\color{black},%
    stringstyle=\color{mylilas},
    commentstyle=\color{mygreen},%
    showstringspaces=false,%without this there will be a symbol in the places where there is a space
    numbers=left,%
    numberstyle={\tiny \color{black}},% size of the numbers
    numbersep=9pt, % this defines how far the numbers are from the text
    %emph=[1]{for,end,break},emphstyle=[1]\color{red}, %some words to emphasise
    %emph=[2]{word1,word2}, emphstyle=[2]{style},
}
%\linenumbers

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\title{On Bernoulli matrix polynomials and matrix exponential approximation }

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{}
%% \address[label1]{}
%% \address[label2]{}

\author[imm]{E.~Defez\corref{cor1}}
\ead{edefez@imm.upv.es}
\author[i3m]{J. Ib\'a\~nez}
\ead{jjibanez@dsic.upv.es}
\author[dsic]{J. Peinado}
\ead{jpeinado@dsic.upv.es}
\author[grupo]{P. Alonso-Jord\'{a}}
\ead{palonso@dsic.upv.es}

\author[i3m]{Jos\'e M. Alonso}
\ead{jmalonso@dsic.upv.es}
\address[imm]{Instituto de Matem\'{a}tica Multidisciplinar}
\address[i3m]{Instituto de Instrumentaci\'{o}n para Imagen Molecular}
\address{Universitat Polit\`{e}cnica de Val\`{e}ncia, Camino de Vera s/n, 46022, Valencia. Spain}
\address[grupo]{Grupo Interdisciplinar de Computaci\'on y Comunicaciones.}
\address[dsic]{Departamento Sistemas Inform\'aticos y Computaci\'on.}

\cortext[cor1]{Corresponding author}

\begin{abstract}
\noindent

\end{abstract}

\begin{keyword}
%% keywords here, in the form: keyword \sep keyword

%% PACS codes here, in the form: \PACS code \sep code

%% MSC codes here, in the form: \MSC code \sep code
%% or \MSC[2008] code \sep code (2000 is the default)
 Hermite matrix approximation \sep Matrix hyperbolic cosine \sep Error analysis
\end{keyword}

\end{frontmatter}

%% \linenumbers

%% main text

\section{Introduction and notation}
The computation of matrix functions has received attention in the last years because of its several applications in different areas of science and technology. Of all the matrix functions, the exponential matrix $e^A$, $A \in \mathbb{C}^{r \times r},$ stands out, due both to its applications in the resolution of systems of differential equations and to the difficulties involved in its computation, see \cite{Vanl75,MoVa78,MoVa03,High08}.\\

Among the proposed methods for the approximate computation of the exponential matrix, two fundamental ones stand out: those based on rational Pad\'e approximations \cite{BaGr96,DiPa00,AlHi09,High04}, and those based on polynomial approximations, both using Taylor series developments  \cite{sastre2015new,SIDR11,RSID16,sastre2019boosting} and using serial developments of Hermite matrix polynomials  \cite{defez1998some,sastre2011efficient}. In general, polynomial approximations showed to be generally more efficient than the Pad\'e algorithm in tests because they are more accurate with a slightly higher cost. All these methods use the basic property of \emph{Scaling-Squaring}, based on the relationship
$$
e^{A}=\left(e^{A/2^s} \right)^{2^s}.
$$

Thus, if ${P_m}(X)$ is a matrix polynomial  approximation of $e^A$, then given a matrix $A$ and a scaling factor $s$,   $P_m(A/2^s)$ is a approximation  $e^{A/2^s}$ and
\begin{equation}
\label{Eq_scaling}
e^{A}\approx \left(P_m(A/2^s) \right)^{2^s}.
\end{equation}


Bernoulli polynomials and Bernoulli numbers have been extensively used in several areas of mathematics, as number theory, because they appear in many mathematical formulas: as in the residual term of the Euler-Maclaurian quadrature rule \cite[p. 63]{olver2010nist}, in the Taylor series expansion of the trigonometric functions $\tan{(x)}, \csc{(x)}$ and $\cot{(x)}$ \cite[p. 116-117]{olver2010nist} and in the Taylor series expansion of the hyperbolic function $\tanh{(x)}$,  \cite[p. 125]{olver2010nist}. They also appear in the well known exact expression  of the  even values of the Riemann zeta function:

$$
\xi(2k)=\sum_{n \geq 1} \frac{1}{n^{2k}}=\frac{(-1)^{k-1}B_{2k}(2\pi)^{2k}}{2(2k)!} , k \geq 1.
$$

They are also used for solving initial value problems \cite{tohidi2013new}, boundary value problems \cite{islam2013numerical,tohidi2013collocation}, high-order linear and nonlinear Fredholm and Volterra integro-differential equations \cite{bhrawy2012new,tohidi2014numerical}, complex differential equations \cite{toutounian2013collocation}, partial differential equations \cite{tohidi2014convergence,tohidi2016new, toutounian2013new}. An excelent survey about Bernoulli polynomials and its applicacions can be found in  \cite{kouba2013lecture}. The development of series functions of Bernoulli polynomials has been studied in \cite{costabile2001expansion,costabile2001expansions}.\\


\textbf{ In this paper we will present a new series development of the exponential matrix in terms of the Bernoulli matrix polynomials, which will confirm that
the polynomial approximations of the exponential matrix are more accurate
and less computationally expensive in most cases than those based on Pad\'{e}
approximants. We are going to verify that its use allows obtaining a new and competitive method for the
approximation of the exponential matrix, with the same computational cost that the Taylor method but generally more accurate.} \\



The organization of the paper is as follows: \textbf{\emph{In section 2 vamos a obtener el desarrollo en serie de la matriz exponencial en t\'erminos de los polinomios matriciales de Bernoulli y explicaremos el m\'etodo para aproximar dicha matriz exponencial. En la seccion 3 daremos el algoritmo utilizado. En la seccion 4 presentamos las pruebas y comparativas}}.\\


 Throughout this paper, we denote by $\mathbb{C}^{r \times r}$ the set of all the complex square matrices of size $n$. We denote $I$ the identity matrix in $ \mathbb{C}^{r \times r}$. Given a polynomial of degree $m$ means an expression of the form $P_m(t)=a_{m} t^m+a_{m-1}t^{m-1}+\cdots+a_{1}t+a_{0}$, where $t$ is a real variable and $a_j$, for $0\leq j \leq m$, are complex numbers, we can define the matrix polynomial $P_m(B)$ for $B \in \mathbb{C}^{r \times r}$  as $P_m(B)=a_{m} B^m+a_{m-1}B^{m-1}+\cdots+a_{1}B+a_{0}I$.  As usual, the matrix norm $\left\|\cdots \right\|$ denotes any subordinate matrix norm; in particular $\left\| \cdots \right\|_{1}$ is the usual $1-$norm. Finally, if ${\cal A}(k, m)$ are matrices in $\mathbb{C}^{n \times n}$ for $m\geq 0, k \geq 0$, from \cite{rainville1960special} it follows that

\begin{equation}\label{rainville}
\sum_{m \geq 0} \sum_{k \geq 0} {\cal A}(k, m)=\sum_{m \geq 0} \sum_{k=0}^{m} {\cal A}(k, m-k).
\end{equation}

\section{On Bernoulli matrix polynomials}
The Bernoulli polynomials $B_n(x)$ are defined in \cite[p.588]{olver2010nist} as the coefficients of the generating function

\begin{equation}\label{Bernoulli1}
g(x, t)= \frac{t e^{tx}}{e^t-1}=\sum_{n \geq 0} \frac{B_n(x)}{n!}t^n  \ , \ |t|<2\pi,
\end{equation}
where $g(x, t)$ is an holomorphic function in $\mathbb{C}$ for the variable $t$ (it has an avoidable singularity in $t=0$) and  Series (\ref{Bernoulli1}) converges if $|t|<2\pi$. Bernoulli polynomials  $B_n(x)$ has the explicit expression

\begin{equation}\label{Bernoulli2}
B_n(x)=\sum_{k=0}^{n} {n \choose k} B_k x^{n-k},
\end{equation}
where the Bernoulli numbers are defined by $B_n=B_n(0)$. Therefore, it follows that the Bernoulli numbers satisfies

\begin{equation}\label{Bernoulli3}
\frac{z}{e^z-1}=\sum_{n \geq 0} \frac{B_n}{n!}z^n  \ , \ |z|<2\pi,
\end{equation}
where
\begin{equation}\label{Bernoulli3a}
B_0=1, \displaystyle  B_{k}= -\sum_{i=0}^{k-1} {k \choose i} \frac{B_i}{k+1-i}, k \geq 1.
\end{equation}
Note that $ B_{3}=B_{5}=\cdots=B_{2k+1}=0$, for
$k\geq 1$. For a matrix $A \in \mathbb{C}^{r \times r}$ we define the the $m-th$ Bernoulli matrix polynomial by the expression

\begin{equation}\label{Bernoulli2matrix}
B_m(A)=\sum_{k=0}^{m} {m \choose k} B_k A^{m-k}.
\end{equation}

We now calculate the exact value of $\displaystyle e^{At}\left(\frac{t}{e^t-1}\right)$, where $A \in \mathbb{C}^{r \times r}$.
By using (\ref{rainville}) and (\ref{Bernoulli2matrix}) one gets


\begin{eqnarray*}
e^{At}\left( \frac{t}{e^t-1} \right) &=& \left(\sum_{n \geq 0} \frac{A^n}{n!}t^n \right) \left(\sum_{k \geq 0} \frac{B_k}{k!}t^k \right) \\
&=& \sum_{n \geq 0} \sum_{k \geq 0} \frac{A^n B_k}{n! k!}t^n t^k  \\
&=& \sum_{n \geq 0}\sum_{k=0}^{n} \frac{B_k}{k!}t^k \frac{A^{n-k}}{(n-k)!}t^{n-k} \\
&=& \sum_{n \geq 0}\left(\sum_{k=0}^{n}{n \choose k} B_k A^{n-k}
\right) \frac{t^{n}}{n!}\\
&=& \sum_{n \geq 0} \frac{ B_n(A) t^{n}}{n!},
\end{eqnarray*}
where $B_n(A)$ is the $n-th$ Bernoulli matrix polynomial defined by (\ref{Bernoulli2matrix}). In this form, we can use the series expansion

\begin{equation}\label{Bernoulli4}
e^{At} = \left(\frac{e^t-1}{t}\right)\sum_{n \geq 0} \frac{ B_n(A) t^{n}}{n!} \ , \ |t|<2\pi,
\end{equation}
to obtain approximations of the matrix exponential. To do this, let's take $s$ the scaling (to be determined) of the matrix $A$ and take $t=1$ in (\ref{Bernoulli4}). We use the matrix exponential  approximation

\begin{equation}\label{Bernoulli5}
e^{A 2^{-s}}\approx  P_{m}(A2^{-s})=\left(e-1 \right)\sum_{n=0}^m \frac{B_n\left(A 2^{-s}\right)}{n!}.
\end{equation}


Approximation (\ref{Bernoulli5}) has the problem that it is not expressed in explicit terms of powers of the matrix $A2^{-s}$. We are going to find that explicit relationship. From
(\ref{Bernoulli5}) we have that, for $m=2$ and using (\ref{Bernoulli2matrix}), one gets



$$
\frac{1}{\left(e-1 \right)}e^{A 2^{-s}}
$$
\begin{eqnarray*}
 & \approx & \sum_{n=0}^2 \frac{B_n\left(A 2^{-s}\right)}{n!} \\
& = & \frac{1}{0!} B_0\left(A 2^{-s}\right) + \frac{1}{1!} B_1\left(A 2^{-s}\right)+ \frac{1}{2!} B_2\left(A 2^{-s}\right) \\
&=& \frac{1}{0!} \left(\sum_{k=0}^{0} {0 \choose k} B_k \left(A 2^{-s}\right)^{0-k} \right) +  \frac{1}{1!} \left(\sum_{k=0}^{1} {1 \choose k} B_k \left(A 2^{-s}\right)^{1-k} \right)\\
&+&  \frac{1}{2!} \left(\sum_{k=0}^{2} {2 \choose k} B_k \left(A 2^{-s}\right)^{2-k} \right) \\
&=& \left(\sum_{k=0}^{2} \frac{1}{k!} {k \choose k} B_k \right) \left(A 2^{-s}\right)^0 + \left(\sum_{k=1}^{2} \frac{1}{k!} {k \choose k-1} B_{k-1} \right) \left(A 2^{-s}\right)^1\\
&+& \left(\sum_{k=2}^{2} \frac{1}{k!} {k \choose k-2} B_{k-2} \right) \left(A 2^{-s}\right)^2.
\end{eqnarray*}

Similarly, for $m=3$:

$$
\frac{1}{\left(e-1 \right)}e^{A 2^{-s}}
$$
\begin{eqnarray*}
& \approx & \sum_{n=0}^3 \frac{B_n\left(A 2^{-s}\right)}{n!} \\
& = & \frac{1}{0!} B_0\left(A 2^{-s}\right) + \frac{1}{1!} B_1\left(A 2^{-s}\right)+ \frac{1}{2!} B_2\left(A 2^{-s}\right)+\frac{1}{3!} B_3\left(A 2^{-s}\right) \\
&=& \frac{1}{0!} \left(\sum_{k=0}^{0} {0 \choose k} B_k \left(A 2^{-s}\right)^{0-k} \right) +  \frac{1}{1!} \left(\sum_{k=0}^{1} {1 \choose k} B_k \left(A 2^{-s}\right)^{1-k} \right)\\
&+&  \frac{1}{2!} \left(\sum_{k=0}^{2} {2 \choose k} B_k \left(A 2^{-s}\right)^{2-k} \right) +  \frac{1}{3!} \left(\sum_{k=0}^{3} {3 \choose k} B_k \left(A 2^{-s}\right)^{3-k} \right)  \\
&=& \left(\sum_{k=0}^{3} \frac{1}{k!} {k \choose k} B_k \right) \left(A 2^{-s}\right)^0 + \left(\sum_{k=1}^{3} \frac{1}{k!} {k \choose k-1} B_{k-1} \right) \left(A 2^{-s}\right)^1 \\
&+& \left(\sum_{k=2}^{3} \frac{1}{k!} {k \choose k-2} B_{k-2} \right) \left(A 2^{-s}\right)^2+\left(\sum_{k=3}^{3} \frac{1}{k!} {k \choose k-3} B_{k-3} \right) \left(A 2^{-s}\right)^3.
\end{eqnarray*}

Taking into account the particular cases $m=2$ and $m=3$, it seems that it is satisfied that

$$
\frac{1}{\left(e-1 \right)}e^{A 2^{-s}} 
$$
\begin{eqnarray}\label{Bernoulli6induccion}
 & \approx & \sum_{n=0}^m \frac{B_n\left(A 2^{-s}\right)}{n!} \nonumber \\
&=& \left(\sum_{k=0}^{m} \frac{1}{k!} {k \choose k} B_k \right) \left(A 2^{-s}\right)^0 + \left(\sum_{k=1}^{m} \frac{1}{k!} {k \choose k-1} B_{k-1} \right) \left(A 2^{-s}\right)^1+\cdots \nonumber \\
&\cdots& + \left(\sum_{k=m}^{m} \frac{1}{k!} {k \choose k-m} B_{k-m} \right) \left(A 2^{-s}\right)^m.
\end{eqnarray}

Let's test the result using induction. Obviously the formula (\ref{Bernoulli6induccion}) is valid for $m=0,1,2,3$. Suppose it is valid for $m$ and let's see for $m+1$. We have


\begin{eqnarray*}
& & \frac{1}{\left(e-1 \right)}e^{A 2^{-s}}  \\
& \approx & \sum_{n=0}^{m+1} \frac{B_n\left(A 2^{-s}\right)}{n!} \\
& = & \sum_{n=0}^{m} \frac{B_n\left(A 2^{-s}\right)}{n!}+\frac{1}{(m+1)!} B_{m+1}\left(A 2^{-s}\right) \\
& = &  \sum_{n=0}^{m} \frac{B_n\left(A 2^{-s}\right)}{n!}+\frac{1}{(m+1)!}\left(  \sum_{k=0}^{m+1} {m+1 \choose k} B_k \left(A 2^{-s}\right)^{m+1-k} \right)\\
&=& \!\!\left(\sum_{k=0}^{m} \frac{1}{k!} {k \choose k} B_k \right)\!\!\left(\!A 2^{-s}\right)^0+\cdots+\!\left(\sum_{k=m}^{m} \frac{1}{k!} {k \choose k\!-\!m} B_{k-m} \right)\!\!\left(\!A 2^{-s}\right)^m\\
&+& \frac{1}{(m+1)!}\left(  \sum_{k=0}^{m+1} {m+1 \choose k} B_k \left(A 2^{-s}\right)^{m+1-k} \right) \\
&=& \left(\sum_{k=0}^{m+1} \frac{1}{k!} {k \choose k} B_k \right)\!\!\left(\!A 2^{-s}\right)^0\!+\!\left(\sum_{k=1}^{m+1} \frac{1}{k!} {k \choose k\!-\!1} B_{k-1} \right)\!\!\left(\!A 2^{-s}\right)^1\!+\cdots \\
&\cdots& +\left(\sum_{k=m+1}^{m+1} \frac{1}{k!} {k \choose k\!-\!(m\!+\!1)} B_{k-(m+1)} \right)\!\!\left(A 2^{-s}\right)^{m+1}.
\end{eqnarray*}

Summarizing we establish the following result:

\begin{Theorem}
\begin{eqnarray}\label{miaBernoulli1}
\frac{1}{\left(e-1 \right)}e^{\left(A 2^{-s}\right)} &\approx &  \sum_{k=0}^m \frac{B_k\left(A 2^{-s}\right)}{k!}= \sum_{i=0}^m \alpha_{i} \left(A 2^{-s}\right)^{i},
\end{eqnarray}

where $\displaystyle \alpha_{i} = \sum_{k=i}^{m} {k \choose k-i} \frac{B_{k-i}}{k!}$.
\end{Theorem}

\input{latex_section_algorithm}
\input{latex_section_tests}

\section*{Acknowledgements}
This work has been partially supported by Spanish Ministerio de Econom\'{\i}a y Competitividad and European Regional Development Fund (ERDF) grants TIN2017-89314-P
and by the Programa de Apoyo a la Investigaci\'on y Desarrollo 2018 of the Universitat Polit\`{e}cnica de Val\`{e}ncia (PAID-06-18) grants SP20180016.

\bibliographystyle{elsarticle-num}
\bibliography{bib_general}
\end{document}
\endinput
%%
%% End of file `elsarticle-template-num.tex'.
