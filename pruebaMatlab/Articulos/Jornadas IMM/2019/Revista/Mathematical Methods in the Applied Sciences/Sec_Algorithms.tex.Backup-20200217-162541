\section{Algorithms} label{section2}
Algoritmo:
 [m,sm,pA,nProd]=selecciona_ms_conEstNormaSinPotencias(f,metodo_f,plataforma,A,mmin,mmax)
 
% Obtenemos los valores de theta y M
[theta,M]=get_theta(f,metodo_f,tipo_error_1,tipo_error_2);
pot=ceil(sqrt(M));

% Buscamos las posiciones (imin e imax) de mmin y mmax en el vector M
if mmin<M(1)
    mmin=M(1);
elseif mmin>M(end)
    mmin=M(end);
end

if mmax<M(1)
    mmax=M(1);
elseif mmin>M(end)
    mmax=M(end);
end

if mmin>mmax
    error('Valor mmin mayor que mmin');
end

i=1;
encontrado=0;
while i<=length(M) && encontrado==0
    if M(i)==mmin
        imin=i;
        encontrado=1;
    else
        i=i+1;
    end
end
if (encontrado==0)
    error('Valor mmin no permitido (emplear 2, 4, 6, 9, 12, 16, 20, 25, 30, 36, 42, 49, 56 o 64)');
end

i=1;
encontrado=0;
while i<=length(M) && encontrado==0
    if M(i)==mmax
        imax=i;
        encontrado=1;
    else
        i=i+1;
    end
end
if (encontrado==0)
    error('Valor mmax no permitido (emplear 2, 4, 6, 9, 12, 16, 20, 25, 30, 36, 42, 49, 56 o 64)');
end

****************************************************************************
selecciona_ms_conEstNormaConPotencias(f,metodo_f,plataforma,A,mmin,mmax)
% Obtenemos los valores de theta y M
[theta,M]=get_theta(f,metodo_f,tipo_error_1,tipo_error_2);
pot=ceil(sqrt(M));

% Buscamos las posiciones (imin e imax) de mmin y mmax en el vector M
if mmin<M(1)
    mmin=M(1);
elseif mmin>M(end)
    mmin=M(end);
end

if mmax<M(1)
    mmax=M(1);
elseif mmin>M(end)
    mmax=M(end);
end

if mmin>mmax
    error('Valor mmin mayor que mmin');
end 

i=1;
encontrado=0;
while i<=length(M) && encontrado==0
    if M(i)==mmin
        imin=i;
        encontrado=1;
    else
        i=i+1;
    end
end
if (encontrado==0)
    error('Valor mmin no permitido (emplear 2, 4, 6, 9, 12, 16, 20, 25, 30, 36, 42, 49, 56 o 64)');
end

i=1;
encontrado=0;
while i<=length(M) && encontrado==0
    if M(i)==mmax
        imax=i;
        encontrado=1;
    else
        i=i+1;
    end
end
if (encontrado==0)
    error('Valor mmax no permitido (emplear 2, 4, 6, 9, 12, 16, 20, 25, 30, 36, 42, 49, 56 o 64)');
end
**************************************************************************************************

function [m,sm,pA,nProd]=selecciona_ms_conEstNormaConPotenciasNuevo(f,metodo_f,plataforma,A,mmin,mmax)

% Obtenemos los valores de theta y M
[theta,M]=get_theta(f,metodo_f,tipo_error_1,tipo_error_2);

% Buscamos las posiciones (imin e imax) de mmin y mmax en el vector M
if mmin<M(1)
    mmin=M(1);
elseif mmin>M(end)
    mmin=M(end);
end

if mmax<M(1)
    mmax=M(1);
elseif mmin>M(end)
    mmax=M(end);
end

if mmin>mmax
    error('Valor mmin mayor que mmin');
end 

i=1;
encontrado=0;
while i<=length(M) && encontrado==0
    if M(i)==mmin
        imin=i;
        encontrado=1;
    else
        i=i+1;
    end
end
if (encontrado==0)
    error('Valor mmin no permitido (emplear 2, 4, 6, 9, 12, 16, 20, 25, 30, 36, 42, 49, 56 o 64)');
end

i=1;
encontrado=0;
while i<=length(M) && encontrado==0
    if M(i)==mmax
        imax=i;
        encontrado=1;
    else
        i=i+1;
    end
end
if (encontrado==0)
    error('Valor mmax no permitido (emplear 2, 4, 6, 9, 12, 16, 20, 25, 30, 36, 42, 49, 56 o 64)');
end

% En caso de trabajar únicamente con los términos pares del polinomio, 
% obtenemos potencias de B=A^2
switch f
    case 'exp'
        factor_s=1;
    case 'cos'
        switch metodo_f
            case 'taylor'
                A=A*A;
                factor_s=0.5;
            case 'bernoulli'
                formulacion=get_formulacion_cos_bernoulli;
                switch formulacion
                    case 'terminos_pares_polinomio_solo_pares'
                        A=A*A;
                        factor_s=0.5;
                    otherwise
                        factor_s=1;
                end
        end
end