\documentclass{article} %[10pt]
\usepackage[english]{babel}
\usepackage{cite}
\usepackage{amsmath}
%\usepackage[latin1]{inputenc}
%\usepackage[dvips]{graphics}
%\usepackage{graphicx}
%\usepackage{epsfig}
%\usepackage{latexsym}
\usepackage{amssymb}
%\usepackage[T1]{fontenc}
\usepackage{theorem}
\usepackage{algorithmicx}
\usepackage[ruled]{algorithm}
\usepackage{algpseudocode}

\usepackage{graphicx} % figuras
\usepackage{subfigure} % subfiguras


\usepackage[active]{srcltx}
%\numberwithin{equation}{section}
\renewcommand{\theequation}{\arabic{equation}}
\DeclareMathOperator{\e}{e} %La exponencial
\DeclareMathOperator{\sinhc}{sinhc}

\newcommand{\re}[1]{\textrm{#1}} %letra redondilla en fórmulas matemáticas
\newcommand{\norm}[1]{\left\Vert#1\right\Vert}
\newcommand{\RE}{\operatorname{Re}}
\newcommand{\IM}{\operatorname{Im}}


\newtheorem{Theorem}{\bf Theorem}[section]
\newtheorem{lemma}{\bf Lemma}%[section]
\newtheorem{definition}{\bf Definition}%[section]
\newtheorem{Corollary}{\bf Corollary}%[section]
\newtheorem{example}{\bf Example}%[section]
\newtheorem{remark}{\bf Remark}%[section]
\newtheorem{proposition}{\bf Proposition}%[section]
\newtheorem{observation}{\bf Note}%[section]
\newtheorem{note}{\bf Note}%[section]

\newenvironment{proof}{\textbf{Proof. \hspace{0.15cm}}}{\hspace*{\fill}$\blacksquare$ \\}




\title{\Large{\textbf{New matrix series expansions for the matrix cosine approximation}}
\footnote{\textbf{Acknowledgements}: This work has been partially supported by Spanish Ministerio
de Econom\'{\i}a y Competitividad and European Regional Development Fund (ERDF) grants
TIN2017-89314-P and by the Programa de Apoyo a la Investigaci\'on y Desarrollo 2018 of the
Universitat Polit\`{e}cnica de Val\`{e}ncia (PAID-06-18) grants SP20180016.
}}
\date{}
\author{E. Defez$^{\star}$, J. Ib\'{a}\~nez$^{\dagger}$, J. M. Alonso$^{\natural}$, J. Peinado$^{\S}$, P. Alonso$^{\natural}$\\
\ \\
\footnotesize  $\star$ Instituto de Matem\'{a}tica Multidisciplinar.\\
\footnotesize  $\dagger$ Instituto de Instrumentaci\'on para Imagen Molecular.\\
\footnotesize $\S$ Departamento de Sistemas Inform\'aticos y Computaci\'on.\\
\footnotesize  $\natural$ Grupo Interdisciplinar de Computaci\'on y Comunicaciones.\\
\small{Universitat Polit\`{e}cnica de Val\`{e}ncia,} \small{Camino de Vera s/n, 46022, Valencia, Espa\~{n}a.}\\
 \footnotesize  edefez@imm.upv.es, $\left\{\right.$jjibanez, jmalonso,  jpeinado,  palonso,$\left.\right\}$@dsic.upv.es}



\begin{document}


\maketitle

\date{}

\section{Introduction and notation}

The computation of matrix trigonometric functions has received remarkable
attention in the last decades due to its usefulness in the solution of systems of
second order linear differential equations. Recently, several state-of-the-art
algorithms have been provided for computing these matrix functions, see \cite{Serb80, dehghan2010computing, High08, alonso2018computing}, in
particular for the matrix cosine function.\\

%The proposed methods for calculating the matrix cosine can be classified into two classes: \emph{Rational approximation methods} and \emph{Polynomial methods}.\\


Among the proposed methods for the approximate computation of the matrix cosine, two fundamental ones stand out: those based on rational approximations \cite{tsitouras2014bounds, Serb79, Serb80, AlHR15}, and those based on polynomial approximations, both using Taylor series developments  \cite{sastre2017two, sastre2019fast} and using serial developments of Hermite matrix polynomials  \cite{defez2019efficient}. In general, polynomial approximations showed to be generally more efficient than the rational algorithm in tests because they are more accurate with a slightly higher cost.\\


Bernoulli polynomials and Bernoulli numbers have been extensively used in several areas of mathematics (an excelent survey about Bernoulli polynomials and its applicacions can be found in  \cite{kouba2013lecture}).\\
% The development of series functions of Bernoulli polynomials has been studied in \cite{costabile2001expansion,costabile2001expansions}.\\


In this paper we will present a new series development of the matrix cosine in terms of the Bernoulli matrix polynomials. We are going to verify that its use allows obtaining a new and competitive method for the approximation of the matrix cosine. \\



The organization of the paper is as follows: \textbf{\emph{In section 2 vamos a obtener el desarrollo en serie de la matriz exponencial en t\'erminos de los polinomios matriciales de Bernoulli y explicaremos el m\'etodo para aproximar dicha matriz exponencial. En la seccion 3 daremos el algoritmo utilizado. En la seccion 4 presentamos las pruebas y comparativas}}.\\


 Throughout this paper, we denote by $\mathbb{C}^{r \times r}$ the set of all the complex square matrices of size $n$. We denote $I$ the identity matrix in $ \mathbb{C}^{r \times r}$. Given a polynomial of degree $m$ means an expression of the form $P_m(t)=a_{m} t^m+a_{m-1}t^{m-1}+\cdots+a_{1}t+a_{0}$, where $t$ is a real variable and $a_j$, for $0\leq j \leq m$, are complex numbers, we can define the matrix polynomial $P_m(B)$ for $B \in \mathbb{C}^{r \times r}$  as $P_m(B)=a_{m} B^m+a_{m-1}B^{m-1}+\cdots+a_{1}B+a_{0}I$.  As usual, the matrix norm $\left\|\cdots \right\|$ denotes any subordinate matrix norm; in particular $\left\| \cdots \right\|_{1}$ is the usual $1-$norm. 
 
\section{On Bernoulli matrix polynomials}
The Bernoulli polynomials $B_n(x)$ are defined in \cite[p.588]{olver2010nist} as the coefficients of the generating function

\begin{equation}\label{Bernoulli1}
g(x, t)= \frac{t e^{tx}}{e^t-1}=\sum_{n \geq 0} \frac{B_n(x)}{n!}t^n  \ , \ |t|<2\pi,
\end{equation}
where $g(x, t)$ is an holomorphic function in $\mathbb{C}$ for the variable $t$ (it has an avoidable singularity in $t=0$) and  Series (\ref{Bernoulli1}) converges if $|t|<2\pi$. Bernoulli polynomials  $B_n(x)$ has the explicit expression

\begin{equation}\label{Bernoulli2}
B_n(x)=\sum_{k=0}^{n} {n \choose k} B_k x^{n-k},
\end{equation}
where the Bernoulli numbers are defined by $B_n=B_n(0)$. Therefore, it follows that the Bernoulli numbers satisfies

\begin{equation}\label{Bernoulli3}
\frac{z}{e^z-1}=\sum_{n \geq 0} \frac{B_n}{n!}z^n  \ , \ |z|<2\pi,
\end{equation}
where
\begin{equation}\label{Bernoulli3a}
B_0=1, \displaystyle  B_{k}= -\sum_{i=0}^{k-1} {k \choose i} \frac{B_i}{k+1-i}, k \geq 1.
\end{equation}
Note that $ B_{3}=B_{5}=\cdots=B_{2k+1}=0$, for
$k\geq 1$. For a matrix $A \in \mathbb{C}^{r \times r}$ we define the the $m-th$ Bernoulli matrix polynomial by the expression

\begin{equation}\label{Bernoulli2matrix}
B_m(A)=\sum_{k=0}^{m} {m \choose k} B_k A^{m-k}.
\end{equation}

We can use the series expansion

\begin{equation}\label{Bernoulli4}
e^{At} = \left(\frac{e^t-1}{t}\right)\sum_{n \geq 0} \frac{ B_n(A) t^{n}}{n!} \ , \ |t|<2\pi,
\end{equation}

to obtain approximations of the matrix exponential. A method based in (\ref{Bernoulli4}) to approximate the exponential matrix had been presented in \cite{defez2019}.\\

From (\ref{Bernoulli4}) we obtain the following expression for the matrix cosine and sine:

\begin{equation}\label{Bernoulli9buena}
\left.\begin{array}{rcl}
\cos{(A)} &=&\displaystyle  \left( \cos{(1)}-1\right)\sum_{n \geq 0} \frac{(-1)^n B_{2n+1}(A)}{(2n+1)!}+ \sin{(1)}\sum_{n \geq 0} \frac{(-1)^n B_{2n}(A)}{(2n)!}, \\
\\
\sin{(A)} &=& \displaystyle   \sin{(1)}\sum_{n \geq 0} \frac{ (-1)^n B_{2n+1}(A)}{(2n+1)!}-\left(\cos{(1)}-1\right)\sum_{n \geq 0} \frac{ (-1)^n B_{2n}(A)}{(2n)!}.
\end{array} \right\}
\end{equation}

Note that unlike the Taylor (and Hermite) polynomials that are even or odd, depending on the parity of the polynomial degree $n$, the Bernoulli polynomials do not verify this property, so in the development of $\cos{(A)}$ and $\sin{(A)}$ all Bernoulli polynomials are needed (and not just the even-numbered).\\

Replacing in (\ref{Bernoulli4}) the value $t$ for $it$ and $-it$ respectively and adding both expressions and simplifying, we get

\begin{equation}\label{Bernoulli11buena}
\sum_{n \geq 0} \frac{(-1)^n B_{2n}(A)}{(2n)!}t^{2n} =\frac{t}{2 \sin{\left( \frac{t}{2} \right)}}\left(\cos{\left(t A- \frac{t}{2}I \right)}  \right)  \ , \ |t|<2\pi.
\end{equation}


Taking $t=2$ in (\ref{Bernoulli11buena}) it follows that 

\begin{equation}\label{Bernoulli10buena1}
\cos{(A)} = \sin{(1)}\sum_{n \geq 0} \frac{(-1)^n 2^{2n} B_{2n}\left(\frac{A+I}{2}\right)}{(2n)!}.
\end{equation}

\section{Numerical Experiments}
From (\ref{Bernoulli9buena}) one gets the approximation

\begin{equation}\label{Bernoulli9buena1}
\displaystyle \cos{(A)} \approx \left(\!\cos{(1)}\!-\!1\right)\!\sum_{n=0}^{m} \frac{(-1)^n B_{2n+1}(A)}{(2n+1)!}\!+\!\sin{(1)}\sum_{n=0}^{m} \frac{(-1)^n B_{2n}(A)}{(2n)!}
\end{equation}

From (\ref{Bernoulli10buena1}) one gets the approximation

\begin{equation}\label{Bernoulli10buena1a}
\displaystyle
\cos{(A)} \approx \sin{(1)}\sum_{n=0}^{m} \frac{(-1)^n 2^{2n} B_{2n}\left(\frac{1}{2}(A+I)\right)}{(2n)!}
\end{equation}



To tested the proposed method, the following algorithms have been implemented on MATLAB R2018b:

\begin{description}
\item $\bullet$	 \emph{cosmber}. New code based on the new developments of Bernoulli matrix polynomials (formulae (\ref{Bernoulli9buena1}) and (\ref{Bernoulli10buena1a})). The MATLAB's implementation \emph{cosmber} uses the new calculation code of $m$ and  $s$ with standard estimation
and calculation of the matrix powers. The maximum value of $m$ to be used is $m=36$.
\item $\bullet$	 \emph{cosmtay}. Code based on the Taylor series for the cosine \cite{sastre2017two}. It will provide a maximum value of $m=16$ considering only the even terms, which would be equivalent to $m=32$ using the terms even and odd.
\item $\bullet$	  \emph{cosmtayher}. Code based on the Hermite series for the cosine \cite{defez2019efficient}. It will provide a maximum value of $m=16$ considering only the even terms, which would be equivalent to $m=32$ using the terms even and odd.
\item $\bullet$	  \emph{cosm}. Code based on the Pad\'e rational approximation for the cosine \cite{AlHR15}. It will provide a maximum value of $m=16$ considering only the even terms, which would be equivalent to $m=32$ using both terms, even and odd.
\end{description}

The following sets of matrices have been used:

\begin{description}
\item[a)] One hundred diagonalizable matrices of size $128 \times 128$. The matrices are obtained as $A=V \cdot D \cdot V^{T}$
where $D$ is a diagonal matrix (with complex or real values) and matrix $V$ is an orthogonal matrix $V=H/16$, where $H$ is a Hadamard matrix.
We have $2.18 \leq \left\|A \right\|_1 \leq 207.52$. The matrix cosine is exactly calculated as $\cos{(A)}=V \cdot \cos{(D)} \cdot V^{T}$.



Results are given in Tables \ref{tabla_er_comparative_test_1} and \ref{tabla_er_comparative_test_1a}. The rows of each table show the percentage of cases in which the relative errors of \texttt{cosmber} (Bernoulli) are lower, greater or equal than the relative errors of \texttt{cosmtay} (Taylor), \texttt{cosmtayher} (Hermite)  and  \texttt{cosm} (Pad\'e).
Graphics with the Normwise relative errors, see \cite[p. 253]{High08}, using (9) and (10) are given in Figure \ref{fig:caso1}.
Graphics with the Performance Profile, see \cite[p. 254]{High08}, are given in Figure \ref{fig:caso1a}.

\begin{figure}[htbp]
\centering
\subfigure[Using formula (\ref{Bernoulli9buena1})]{\includegraphics[scale=0.32]{Fig_cos_diag_hadamard_complex_n128_nd256_normwise_cosmber_cosmtay_cosmtayher_cosm_9.eps}} %width=40mm
\subfigure[Using formula (\ref{Bernoulli10buena1a})]{\includegraphics[scale=0.32]{Fig_cos_diag_hadamard_complex_n128_nd256_normwise_cosmber_cosmtay_cosmtayher_cosm.eps}}
\caption{Test 1. Diagonalizable matrices. Normwise relative errors} \label{fig:caso1}
\end{figure}



\begin{figure}[htbp]
\centering
\subfigure[Using formula (\ref{Bernoulli9buena1})]{\includegraphics[scale=0.32]{Fig_cos_diag_hadamard_complex_n128_nd256_nprofile__cosmber_cosmtay_cosmtayher_cosm_9.eps}} %width=40mm
\subfigure[Using formula (\ref{Bernoulli10buena1a})]{\includegraphics[scale=0.32]{Fig_cos_diag_hadamard_complex_n128_nd256_nprofile__cosmber_cosmtay_cosmtayher_cosm.eps}}
\caption{Test 1. Diagonalizable matrices. Performance Profile.} \label{fig:caso1a}
\end{figure}


\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli9buena1})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $43.00\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $57.00\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $0\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $37.00\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $63.00\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $0\%$ \\\hline
$E(cosmber)<E(cosm)$ & $84.00\%$ \\\hline
$E(cosmber)>E(cosm)$ & $16.00\%$ \\\hline
$E(cosmber)=E(cosm)$  & $0\%$ \\\hline
\end{tabular}
\label{tabla_er_comparative_test_1}
\end{center}
\end{table} 

\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli10buena1a})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $67.00\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $33.00\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $0\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $60.00\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $40.00\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $0\%$ \\\hline
$E(cosmber)<E(cosm)$ & $85.00\%$ \\\hline
$E(cosmber)>E(cosm)$ & $15.00\%$ \\\hline
$E(cosmber)=E(cosm)$  & $0\%$ \\\hline
\end{tabular}
\label{tabla_er_comparative_test_1a}
\end{center}
\end{table}




\item[b)] One hundred  non diagonalizables matrices of size $128 \times 128$. The matrices are obtained as $A=V \cdot J \cdot V^{-1}$ where
$J$ is a Jordan matrix with complex eigenvalues with module less than $10$ and random algebraic multiplicity between $1$ and $5$, and matrix $V$ is a random matrix with elements in the interval $[-0.5,0.5]$. We have $1279.16 \leq \left\|A \right\|_1 \leq 87886.4$. The matrix cosine
is exactly calculated as $\cos{(A)}=V \cdot \cos{(J)} \cdot V^{-1}$. 

Results are given in Tables \ref{tabla_er_comparative_test_2} and \ref{tabla_er_comparative_test_2a}. Graphics of the Normwise relative errors and the Performance Profile are given in Figures \ref{fig:caso2} and \ref{fig:caso2a}.

\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli9buena1})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $84.00\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $16.00\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $0\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $85.00\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $15.00\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $0\%$ \\\hline
$E(cosmber)<E(cosm)$ & $86.00\%$ \\\hline
$E(cosmber)>E(cosm)$ & $14.00\%$ \\\hline
$E(cosmber)=E(cosm)$  & $0\%$ \\\hline
\end{tabular}
\label{tabla_er_comparative_test_2}
\end{center}
\end{table} 


\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli10buena1a})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $84.00\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $16.00\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $0\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $85.00\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $15.00\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $0\%$ \\\hline
$E(cosmber)<E(cosm)$ & $86.00\%$ \\\hline
$E(cosmber)>E(cosm)$ & $14.00\%$ \\\hline
$E(cosmber)=E(cosm)$  & $0\%$ \\\hline
\end{tabular}
\label{tabla_er_comparative_test_2a}
\end{center}
\end{table} 


\begin{figure}[htbp]
\centering
\subfigure[Using formula (\ref{Bernoulli9buena1})]{\includegraphics[scale=0.32]{Fig_cos_jordan_random_complex_n128_boundvp10_maxmult5_nd256_normwise_cosmber_cosmtay_cosmtayher_cosm_9.eps}} %width=40mm
\subfigure[Using formula (\ref{Bernoulli10buena1a})]{\includegraphics[scale=0.32]{Fig_cos_jordan_random_complex_n128_boundvp10_maxmult5_nd256_normwise_cosmber_cosmtay_cosmtayher_cosm.eps}}
\caption{Test 2. Non-diagonalizable matrices. Normwise relative errors} \label{fig:caso2}
\end{figure}


\begin{figure}[htbp]
\centering
\subfigure[Using formula (\ref{Bernoulli9buena1})]{\includegraphics[scale=0.32]{Fig_cos_jordan_random_complex_n128_boundvp10_maxmult5_nd256_nprofile__cosmber_cosmtay_cosmtayher_cosm_9.eps}} %width=40mm
\subfigure[Using formula (\ref{Bernoulli10buena1a})]{\includegraphics[scale=0.32]{Fig_cos_jordan_random_complex_n128_boundvp10_maxmult5_nd256_nprofile__cosmber_cosmtay_cosmtayher_cosm.eps}}
\caption{Test 2. Non-diagonalizable matrices. Performance Profile.} \label{fig:caso2a}
\end{figure}



\item[c)] $42$ matrices from the Matrix Computation Toolbox \cite{higham1995test} with size $128 \times 128$. These matrices have been chosen because they have more varied and significant characteristics.

Results are given in Tables \ref{tabla_er_comparative_test_3} and \ref{tabla_er_comparative_test_3a}. Graphics of the Normwise relative errors and the Performance Profile are given in Figures \ref{fig:caso3} and \ref{fig:caso3a}.

\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli9buena1})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $42.86\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $57.14\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $0\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $28.57\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $71.43\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $0\%$ \\\hline
$E(cosmber)<E(cosm)$ & $61.90\%$ \\\hline
$E(cosmber)>E(cosm)$ & $38.10\%$ \\\hline
$E(cosmber)=E(cosm)$  & $0\%$ \\\hline
\end{tabular}
\label{tabla_er_comparative_test_3}
\end{center}
\end{table}


\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli10buena1a})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $35.71\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $64.29\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $0\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $19.05\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $80.95\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $0\%$ \\\hline
$E(cosmber)<E(cosm)$ & $50.00\%$ \\\hline
$E(cosmber)>E(cosm)$ & $50.00\%$ \\\hline
$E(cosmber)=E(cosm)$  & $0\%$ \\\hline
\end{tabular}
\label{tabla_er_comparative_test_3a}
\end{center}
\end{table}


\begin{figure}[htbp]
\centering
\subfigure[Using formula (\ref{Bernoulli9buena1})]{\includegraphics[scale=0.32]{Fig_cos_toolbox_n128_nd256_normwise_cosmber_cosmtay_cosmtayher_cosm_9.eps}} %width=40mm
\subfigure[Using formula (\ref{Bernoulli10buena1a})]{\includegraphics[scale=0.32]{Fig_cos_toolbox_n128_nd256_normwise_cosmber_cosmtay_cosmtayher_cosm.eps}}
\caption{Test 3. Matrix Computation Toolbox. Normwise relative errors} \label{fig:caso3}
\end{figure}


\begin{figure}[htbp]
\centering
\subfigure[Using formula (\ref{Bernoulli9buena1})]{\includegraphics[scale=0.32]{Fig_cos_toolbox_n128_nd256_nprofile__cosmber_cosmtay_cosmtayher_cosm_9.eps}} %width=40mm
\subfigure[Using formula (\ref{Bernoulli10buena1a})]{\includegraphics[scale=0.32]{Fig_cos_toolbox_n128_nd256_nprofile__cosmber_cosmtay_cosmtayher_cosm.eps}}
\caption{Test 3. Matrix Computation Toolbox. Performance Profile.} \label{fig:caso3a}
\end{figure}






\item[d)] $17$ matrices from the Eigtool Matlab package~\cite{wrighteigtool} with size $128 \times 128$

Results are given in Tables \ref{tabla_er_comparative_test_4} and \ref{tabla_er_comparative_test_4a}. Graphics of the Normwise relative errors and the Performance Profile are given in Figures \ref{fig:caso4} and \ref{fig:caso4a}.

\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli9buena1})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $35.29\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $64.71\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $0\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $17.65\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $82.35\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $0\%$ \\\hline
$E(cosmber)<E(cosm)$ & $35.29\%$ \\\hline
$E(cosmber)>E(cosm)$ & $64.71\%$ \\\hline
$E(cosmber)=E(cosm)$  & $0\%$ \\\hline
\end{tabular} 
\label{tabla_er_comparative_test_4}
\end{center}
\end{table}

\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli10buena1a})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $16.67\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $77.78\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $5.56\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $5.56\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $88.89\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $5.56\%$ \\\hline
$E(cosmber)<E(cosm)$ & $27.78\%$ \\\hline
$E(cosmber)>E(cosm)$ & $66.67\%$ \\\hline
$E(cosmber)=E(cosm)$  & $5.56\%$ \\\hline
\end{tabular}
\label{tabla_er_comparative_test_4a}
\end{center}
\end{table}
\end{description}

\begin{figure}[htbp]
\centering
\subfigure[Using formula (\ref{Bernoulli9buena1})]{\includegraphics[scale=0.32]{Fig_cos_eigtool_n128_nd256_normwise_cosmber_cosmtay_cosmtayher_cosm_9.eps}} %width=40mm
\subfigure[Using formula (\ref{Bernoulli10buena1a})]{\includegraphics[scale=0.32]{Fig_cos_eigtool_n128_nd256_normwise_cosmber_cosmtay_cosmtayher_cosm.eps}}
\caption{Test 4. Eigtool Matlab package. Normwise relative errors} \label{fig:caso4}
\end{figure}


\begin{figure}[htbp]
\centering
\subfigure[Using formula (\ref{Bernoulli9buena1})]{\includegraphics[scale=0.32]{Fig_cos_eigtool_n128_nd256_nprofile__cosmber_cosmtay_cosmtayher_cosm_9.eps}} %width=40mm
\subfigure[Using formula (\ref{Bernoulli10buena1a})]{\includegraphics[scale=0.32]{Fig_cos_eigtool_n128_nd256_nprofile__cosmber_cosmtay_cosmtayher_cosm.eps}}
\caption{Test 4. Eigtool Matlab package. Performance Profile.} \label{fig:caso4a}
\end{figure}

\section{todo junto}

$259$ matrices: $100$ diagonalizable, $100$ non-diagonalizable, $42$ from toolbox [15] and $17$ from Eigtool [16]. Size $128 \times 128$. Results are given in Tables \ref{tabla_er_comparative_test_todo} and \ref{tabla_er_comparative_test_todoa}. The rows of each table show the percentage of cases in which the relative errors of \texttt{cosmber} (Bernoulli) are lower, greater or equal than the relative errors of \texttt{cosmtay} (Taylor), \texttt{cosmtayher} (Hermite)  and  \texttt{cosm} (Pad\'e).

\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli9buena1})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $58.30\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $41.70\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $0\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $52.90\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $47.10\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $0\%$ \\\hline
$E(cosmber)<E(cosm)$ & $77.99\%$ \\\hline
$E(cosmber)>E(cosm)$ & $22.01\%$ \\\hline
$E(cosmber)=E(cosm)$  & $0\%$ \\\hline
\end{tabular} 
\label{tabla_er_comparative_test_todo}
\end{center}
\end{table}

\begin{table}[H]\begin{center}
\caption{Using approximation (\ref{Bernoulli10buena1a})}
\begin{tabular}{cc}\hline
$E(cosmber)<E(cosmtay)$ & $66.02\%$ \\\hline
$E(cosmber)>E(cosmtay)$ & $33.98\%$ \\\hline
$E(cosmber)=E(cosmtay)$  & $0\%$ \\\hline
$E(cosmber)<E(cosmtayher)$ & $60.23\%$ \\\hline
$E(cosmber)>E(cosmtayher)$ & $39.77\%$ \\\hline
$E(cosmber)=E(cosmtayher)$  & $0\%$ \\\hline
$E(cosmber)<E(cosm)$ & $76.06\%$ \\\hline
$E(cosmber)>E(cosm)$ & $23.94\%$ \\\hline
$E(cosmber)=E(cosm)$  & $0\%$ \\\hline
\end{tabular}
\label{tabla_er_comparative_test_todoa}
\end{center}
\end{table}

\bibliographystyle{elsarticle-num}
\bibliography{bib_imm2019}
\end{document}

